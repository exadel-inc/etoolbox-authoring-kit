{% extends './base.njk' %}
{% set baseClass = 'sidebar-layout' %}

{% block content %}
  {% include 'navigation/header.njk' %}
  {% include 'navigation/sidebar.njk' %}
  <main class="esl-scrollable-content">
    <div class="content {{ containerCls or 'container markdown-container' }} {{ 'container-aside' if aside }}">
      {{ content | safe or 'No content.' }}
    </div>
    <footer class="footer-compact container-fluid">
      {% include 'navigation/footer-compact.njk' %}
    </footer>
  </main>
  <esl-scrollbar target="::prev" class="main-scroll"></esl-scrollbar>
  <div class="header-shadow"></div>

<script>
  const anchors = document.querySelectorAll('.content h3');
  if (anchors.length) {
    document.querySelector('.content h2').insertAdjacentHTML('afterend', `<eak-anchor-nav>
                                                                            <div class="anchor-nav-wrapper">
                                                                              <esl-trigger class="dropdown-trigger" target="::next">Trigger</esl-trigger>
                                                                              <esl-toggleable class="anchors-container open" close-on=".anchor-item">
                                                                                <ul></ul>
                                                                              </esl-toggleable>
                                                                            </div>
                                                                          </eak-anchor-nav>`);

    const container = document.querySelector('.anchors-container ul');

    Array.from(anchors)
      .forEach(function(item) {
        if (item.id) {
          const li = document.createElement('li');
          li.classList.add('anchor-wrap');
          const anchor = document.createElement('a');
          anchor.classList.add('anchor-item');
          anchor.innerHTML = item.innerHTML;
          anchor.href = '#' + item.id;
          const indicator = document.createElement('span');
          indicator.classList.add('anchor-indicator');

          anchor.append(indicator);
          li.append(anchor);
          container.append(li);
        }
      })
  }

</script>
{% endblock %}


