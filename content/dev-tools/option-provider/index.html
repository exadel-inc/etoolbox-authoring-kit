<head> <title>Option Provider - Exadel Authoring Kit</title> <link rel="canonical" href="https://authoring-kit.com/content/dev-tools/option-provider"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <link rel="icon" type="image/png" href="/assets/logo-64x64.png"> <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-SFSRZREMCC"></script> <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-SFSRZREMCC")</script> <script>!function(){var e="";"getRootNode"in Element.prototype&&window.customElements?window.scrollBy&&window.IntersectionObserver&&window.ResizeObserver&&window.ResizeObserver||(e="light"):e="medium",e&&document.write('<script type="text/javascript" src="/bundles/polyfill-'+e+'.js"><\/script>')}()</script> <link rel="stylesheet" type="text/css" href="/bundles/site.css"> </head> <body> <div class="page sidebar-layout"> <header class="header"> <nav class="header-container container"> <a class="header-link header-logo logo-animated" href="/" aria-label="landing page"> <svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 38 38"> <g clip-path="url(#a)" fill-rule="evenodd" clip-rule="evenodd" fill="#0082CA"> <path d="M23.7024 17.967a1.4253 1.4253 0 0 0 1.4276.7264 1.4273 1.4273 0 0 0 1.2019-1.0588 1.4265 1.4265 0 0 0-.16-1.0926L20.3532 6.4634A1.4044 1.4044 0 0 0 19 5.762a1.427 1.427 0 0 0-1.354.7014L6.9582 24.9731a1.4257 1.4257 0 0 0 .5227 1.9477 1.424 1.424 0 0 0 .527.1786 1.4243 1.4243 0 0 0 1.054-.2829 1.4253 1.4253 0 0 0 .3667-.4184L19 9.8206l4.7024 8.1464Z"></path> <path d="m31.0418 24.8667-2.2336-3.8608a1.399 1.399 0 0 0-.6642-.5941 1.4256 1.4256 0 0 0-.7608-.2253H15.7457a1.4251 1.4251 0 0 0 0 2.85h10.9512l1.8763 3.2534a1.426 1.426 0 0 0 2.5758-.3632 1.4255 1.4255 0 0 0-.1072-1.06Z"></path> <path d="M38 19C38 8.5029 29.4971 0 19 0S0 8.5029 0 19s8.502 19 19 19a18.859 18.859 0 0 0 8.134-1.8311 1.4094 1.4094 0 0 1-.7599-1.2113 17.567 17.567 0 0 1-7.3599 1.6148c-9.7017 0-17.575-7.8724-17.575-17.5751C1.4392 9.2947 9.2982 1.425 19 1.425c9.7017 0 17.575 7.876 17.575 17.575a17.4351 17.4351 0 0 1-3.1594 10.0467 1.4199 1.4199 0 0 1 .5471 1.1164v.5462A18.924 18.924 0 0 0 38 19Z"></path> <path d="M32.3001 29.6877h-4.2732a.7133.7133 0 0 0 0 1.4268h3.562v1.1873a.7125.7125 0 0 0 1.425 0v-1.8967a.7159.7159 0 0 0-.2081-.5068.7143.7143 0 0 0-.5057-.2106ZM32.0624 33.9627h-3.3261v-1.425a.7125.7125 0 1 0-1.425 0v2.1379a.7147.7147 0 0 0 .7094.7094h4.0373a.7125.7125 0 0 0 0-1.425l.0044.0027Z"></path> </g> <defs> <clipPath id="a"> <path fill="#fff" d="M0 0h38v38H0z"></path> </clipPath> </defs> </svg> <span class="header-short-name">Exadel Authoring Kit</span> <span class="header-long-name">Exadel Authoring Kit for AEM</span> </a> <ul class="header-links unstyled-list"> <li class="header-item"> <a class="header-link" href=".">Manuals</a> </li> <li class="header-item"> <a class="header-link" href="" target="_blank">API Docs</a> </li> <li class="header-item"> <a class="header-link" href="" target="_blank">Blog</a> </li> <li class="header-item"> <a class="header-link fill-primary" href="https://github.com/exadel-inc/etoolbox-authoring-kit" target="_blank" rel="noopener norefferer"> <svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"> <path d="M10.6666 14.6668v-2.58a2.246 2.246 0 0 0-.6266-1.74c2.0933-.2333 4.2933-1.0267 4.2933-4.6667a3.6268 3.6268 0 0 0-1-2.5 3.38 3.38 0 0 0-.06-2.5133s-.7867-.2333-2.6067.9867a8.92 8.92 0 0 0-4.6666 0C4.18.4335 3.3933.6668 3.3933.6668a3.38 3.38 0 0 0-.06 2.5133 3.6267 3.6267 0 0 0-1 2.52c0 3.6133 2.2 4.4067 4.2934 4.6667A2.2458 2.2458 0 0 0 6 12.0868v2.58" fill="#0082CA"></path> <path d="M6 12.6668c-3.3333 1-3.3333-1.6667-4.6667-2m9.3333 4v-2.58a2.246 2.246 0 0 0-.6266-1.74c2.0933-.2333 4.2933-1.0267 4.2933-4.6667a3.6268 3.6268 0 0 0-1-2.5 3.38 3.38 0 0 0-.06-2.5133s-.7867-.2333-2.6067.9867a8.92 8.92 0 0 0-4.6666 0C4.18.4335 3.3933.6668 3.3933.6668a3.38 3.38 0 0 0-.06 2.5133 3.6267 3.6267 0 0 0-1 2.52c0 3.6133 2.2 4.4067 4.2934 4.6667A2.2458 2.2458 0 0 0 6 12.0868v2.58h4.6666Z" stroke="#0082CA" stroke-linecap="round" stroke-linejoin="round"></path> </svg> </a> </li> </ul> <div class="header-utility"> <esl-trigger class="header-hamburger" target="#sidebar" aria-label="navigation menu"></esl-trigger> </div> </nav> </header> <eak-sidebar id="sidebar" class="open" aria-label="Site Navigation"> <nav class="sidebar-nav"> <a class="sidebar-heading" href="/"> <span class="sidebar-logo"> <svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 38 38"> <g clip-path="url(#a)" fill-rule="evenodd" clip-rule="evenodd" fill="#0082CA"> <path d="M23.7024 17.967a1.4253 1.4253 0 0 0 1.4276.7264 1.4273 1.4273 0 0 0 1.2019-1.0588 1.4265 1.4265 0 0 0-.16-1.0926L20.3532 6.4634A1.4044 1.4044 0 0 0 19 5.762a1.427 1.427 0 0 0-1.354.7014L6.9582 24.9731a1.4257 1.4257 0 0 0 .5227 1.9477 1.424 1.424 0 0 0 .527.1786 1.4243 1.4243 0 0 0 1.054-.2829 1.4253 1.4253 0 0 0 .3667-.4184L19 9.8206l4.7024 8.1464Z"></path> <path d="m31.0418 24.8667-2.2336-3.8608a1.399 1.399 0 0 0-.6642-.5941 1.4256 1.4256 0 0 0-.7608-.2253H15.7457a1.4251 1.4251 0 0 0 0 2.85h10.9512l1.8763 3.2534a1.426 1.426 0 0 0 2.5758-.3632 1.4255 1.4255 0 0 0-.1072-1.06Z"></path> <path d="M38 19C38 8.5029 29.4971 0 19 0S0 8.5029 0 19s8.502 19 19 19a18.859 18.859 0 0 0 8.134-1.8311 1.4094 1.4094 0 0 1-.7599-1.2113 17.567 17.567 0 0 1-7.3599 1.6148c-9.7017 0-17.575-7.8724-17.575-17.5751C1.4392 9.2947 9.2982 1.425 19 1.425c9.7017 0 17.575 7.876 17.575 17.575a17.4351 17.4351 0 0 1-3.1594 10.0467 1.4199 1.4199 0 0 1 .5471 1.1164v.5462A18.924 18.924 0 0 0 38 19Z"></path> <path d="M32.3001 29.6877h-4.2732a.7133.7133 0 0 0 0 1.4268h3.562v1.1873a.7125.7125 0 0 0 1.425 0v-1.8967a.7159.7159 0 0 0-.2081-.5068.7143.7143 0 0 0-.5057-.2106ZM32.0624 33.9627h-3.3261v-1.425a.7125.7125 0 1 0-1.425 0v2.1379a.7147.7147 0 0 0 .7094.7094h4.0373a.7125.7125 0 0 0 0-1.425l.0044.0027Z"></path> </g> <defs> <clipPath id="a"> <path fill="#fff" d="M0 0h38v38H0z"></path> </clipPath> </defs> </svg> </span> <span class="sidebar-title">Exadel Authoring Kit for AEM</span> </a> <div class="sidebar-content"> <div class="sidebar-scrollable-content esl-scrollable-content"> <ul class="sidebar-nav-list"> <li class="sidebar-nav-item"> <div class="sidebar-nav-item-heading"> Getting Started </div> <div class="sidebar-nav-secondary"> <ul class="sidebar-nav-secondary-list"> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/content/getting-started/installation/"> Installation </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/content/getting-started/common-use-cases/"> Common Use Cases </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/content/getting-started/popular-articles/"> Popular Articles </a> </li> </ul> </div> </li> <li class="sidebar-nav-item"> <div class="sidebar-nav-item-heading"> Developer Tools </div> <div class="sidebar-nav-secondary"> <ul class="sidebar-nav-secondary-list"> <li class="sidebar-nav-secondary-item sidebar-secondary-nav-item-children"> <div class="sidebar-nav-item-heading"> <esl-trigger class="sidebar-nav-item-trigger sidebar-nav-item-arrow" target="::parent::next"> Component Management </esl-trigger> </div> <esl-panel id="sidebar-component-management-menu" class="sidebar-nav-secondary nav-secondary-panel" group=" component-management"> <ul class="sidebar-nav-secondary-list"> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/content/dev-tools/component-management/component-structure/"> Component Structure </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/content/dev-tools/component-management/dialog-layout/"> Dialog Layout </a> </li> <li class="sidebar-nav-secondary-item sidebar-secondary-nav-item-children"> <div class="sidebar-nav-item-heading"> <esl-trigger class="sidebar-nav-item-trigger sidebar-nav-item-arrow" target="::parent::next"> Dialog Fields </esl-trigger> </div> <esl-panel id="sidebar-dialog-fields-menu" class="sidebar-nav-secondary nav-secondary-panel" group=" dialog-fields"> <ul class="sidebar-nav-secondary-list"> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/content/dev-tools/component-management/dialog-fields/dialog-field/"> Dialog Field </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/content/dev-tools/component-management/dialog-fields/widgets/"> Widgets (A-Z) </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/content/dev-tools/component-management/dialog-fields/configuring-rte/"> Configuring RTE </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/content/dev-tools/component-management/dialog-fields/configuring-fieldset/"> Configuring Fieldset </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/content/dev-tools/component-management/dialog-fields/configuring-multifield/"> Configuring Multifield </a> </li> </ul> </esl-panel> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/content/dev-tools/component-management/additional-properties/"> Additional Properties </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/content/dev-tools/component-management/reusing-code/"> Reusing Code </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/content/dev-tools/component-management/customizing-toolkit/"> Customization </a> </li> </ul> </esl-panel> </li> <li class="sidebar-nav-secondary-item sidebar-secondary-nav-item-children"> <div class="sidebar-nav-item-heading"> <esl-trigger class="sidebar-nav-item-trigger sidebar-nav-item-arrow" target="::parent::next"> DependsOn </esl-trigger> </div> <esl-panel id="sidebar-depends-on-menu" class="sidebar-nav-secondary nav-secondary-panel" group=" depends-on"> <ul class="sidebar-nav-secondary-list"> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/content/dev-tools/depends-on/introduction/"> Introduction </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/content/dev-tools/depends-on/usage/"> Usage </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/content/dev-tools/depends-on/api/"> API </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/content/dev-tools/depends-on/examples/"> Examples </a> </li> </ul> </esl-panel> </li> <li class="sidebar-nav-secondary-item active" aria-selected="true"> <a class="sidebar-nav-secondary-link" aria-current="page" href="/content/dev-tools/option-provider/"> Option Provider </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/content/dev-tools/injectors/"> Injectors </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/content/dev-tools/allowed-components/"> Allowed Components </a> </li> </ul> </div> </li> <li class="sidebar-nav-item"> <div class="sidebar-nav-item-heading"> Authoring Tools </div> <div class="sidebar-nav-secondary"> <ul class="sidebar-nav-secondary-list"> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/content/authoring-tools/etoolbox-lists/"> Etoolbox Lists </a> </li> </ul> </div> </li> </ul> <div class="sidebar-footer-copyright"> EAK v2.4.1 © 2024<a class="sidebar-footer-link" href="https://exadel.com/" target="_blank" rel="noopener norefferer">Exadel</a>, Inc. </div> </div> <esl-scrollbar class="sidebar-scrollbar" target="::prev"></esl-scrollbar> </div> </nav> </eak-sidebar> <main class="esl-scrollable-content"> <div class="content mb-4 container markdown-container"> <div class="content-page-title"> <span class="parent-page">Developer Tools / </span> <h1 class="current-page">Feeding data to selection widgets with OptionProvider</h1> </div> <p>Several Granite/Touch UI components, such as <em>RadioGroup</em> or <em>Select</em>, facilitate selecting from a set of options. Traditionally, the options are either inlined (the ToolKit offers its <code>@RadioButton</code> and <code>@Option</code> annotations for that) or supplied via a datasource. Both ways have their limitations; the in-line options are not dynamic and potentially lead to a lot of copy-pasting across components, while the <em>datasource</em> pattern requires creating a datasource servlet for every occasion.</p> <p>The ToolKit is bundled with the <em>OptionProvider</em> subsystem that aims at streamlining the usage of dynamic options without programming overhead.</p> <p>The <em>OptionProvider</em> is capable of delivering options in two modes; for a static Granite component it serves as a conventional <em>datasource</em>. Also it has a JSON-supplying servlet that allows for retrieving and updating options dynamically even after a Granite UI has already been rendered.</p> <p>The options managed by <em>OptionProvider</em> can originate from:</p> <ul> <li>a dedicated structured data page, such as an EToolbox List or an ACS Commons List;</li> <li>an arbitrary JCR node with children (each option will then be represented by a single child node);</li> <li>a tag folder;</li> <li>a Java class containing a set of constants, or an enum;</li> <li>a static list of values (in a string array that can be made constant and shared across the project).</li> </ul> <p>Moreover, a single <em>OptionProvider</em> can join several data sources, merge and sort their options in a common sequence, enjoy having a "primary" and "fallback" option source, etc.</p> <h2 id="static-optionprovider-setup">Static OptionProvider setup</h2> <p>For a static Granite UI component, OptionProvider is set up via a property of such annotations as <code>ButtonGroup</code>, <code>@RadioGroup</code>, or <code>@Select</code> (see the samples below):</p> <pre><code class="language-java"><span class="token annotation punctuation">@AemComponent</span><span class="token punctuation">(</span>
        path <span class="token operator">=</span> <span class="token string">"path/to/my/component"</span><span class="token punctuation">,</span>
        title <span class="token operator">=</span> <span class="token string">"My AEM Component"</span>
<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Dialog</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@DialogField</span>
    <span class="token annotation punctuation">@RadioGroup</span><span class="token punctuation">(</span>
        buttonProvider <span class="token operator">=</span> <span class="token annotation punctuation">@OptionProvider</span><span class="token punctuation">(</span><span class="token annotation punctuation">@OptionSource</span><span class="token punctuation">(</span>
            value <span class="token operator">=</span> <span class="token string">"/path/to/tag/folder"</span><span class="token punctuation">,</span>
            textMember <span class="token operator">=</span> <span class="token string">"jcr:title"</span><span class="token punctuation">,</span>
            valueMember <span class="token operator">=</span> <span class="token string">"name"</span><span class="token punctuation">,</span>
            attributeMembers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"first"</span><span class="token punctuation">,</span> <span class="token string">"second"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            textTransform <span class="token operator">=</span> <span class="token string">"capitalize"</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token class-name">String</span> tag<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* ...Elsewhere in the code */</span>

<span class="token annotation punctuation">@AemComponent</span><span class="token punctuation">(</span>
        path <span class="token operator">=</span> <span class="token string">"path/to/my/other/component"</span><span class="token punctuation">,</span>
        title <span class="token operator">=</span> <span class="token string">"My Other AEM Component"</span>
<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Dialog</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@DialogField</span>
    <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span>
        optionProvider <span class="token operator">=</span> <span class="token annotation punctuation">@OptionProvider</span><span class="token punctuation">(</span>
            value <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token annotation punctuation">@OptionSource</span><span class="token punctuation">(</span>
                    value <span class="token operator">=</span> <span class="token string">"/content/path/to/acs/list"</span><span class="token punctuation">,</span>
                    fallback <span class="token operator">=</span> <span class="token string">"https://acme.com/apis/sample.json/data/path"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token annotation punctuation">@OptionSource</span><span class="token punctuation">(</span>
                    value <span class="token operator">=</span> <span class="token string">"/content/path/to/etoolbox/list"</span><span class="token punctuation">,</span>
                    fallback <span class="token operator">=</span> <span class="token string">"/content/path/to/node"</span><span class="token punctuation">,</span>
                    textMember <span class="token operator">=</span> <span class="token string">"title"</span><span class="token punctuation">,</span>
                    valueMember <span class="token operator">=</span> <span class="token string">"descr"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            prepend <span class="token operator">=</span> <span class="token string">"None:none"</span><span class="token punctuation">,</span>
            selectedValue <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">,</span>
            sorted <span class="token operator">=</span> <span class="token boolean">true</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    <span class="token class-name">String</span> optionList<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <p><code>@OptionProvider</code> annotation has the following properties:</p> <p><em>value</em> - contains one or more <code>@OptionSource</code> objects, each referring to a single data source (see below);</p> <p><em>prepend</em> - if specified, defines one or more extra options that will be inserted in the beginning of the option list independently of items acquired via the option source(s). This may be a kind of "none" or "default" option. Each extra option string must consist of a label and a value separated with a colon (<code>:</code>). A value may be an empty string, in which case the option ends with the <code>:</code> sign. If a label or a value itself must contain a colon, it can be escaped with <code>\</code>. If an option with a similar <em>value</em> is already present, the extra option will not be added;</p> <p><em>append</em> - same as <em>prepend</em>, but the extra item(s) are appended to the option list. A valid list may consist of only prepended and/or appended options without the "external" part;</p> <p><em>exclude</em> - if specified, defines one or more options (coming from an external source) that should be skipped for the current component. A string passed must match either the option's value or text. The matching is case-insensitive. The wildcard symbol (*) can be used in matching strings;</p> <p><em>selectedValue</em> - if set to a string that matches the value or the label of one of the datasource options, this option will be rendered as selected by default;</p> <p><em>sorted</em> - if set to true, options will be sorted in their labels' alphabetical order regardless of the order they arrived from JCR. However, the <em>prepended</em> and <em>appended</em> options will appear in the order they were specified by the developer and will remain at the beginning and the end, respectively.</p> <p>Every <code>@OptionSource</code> object can be specified with the following properties:</p> <p><em>value</em> - defines the path to a List-like structure, a node tree, a tag folder, or else an URL of an HTTP server that outputs options in JSON format, or a fully qualified name of a Java class (see below).</p> <p>Plain paths and <em>path references</em> are supported. I.e. if a value is presented like <code>/typical/jcr/path</code>, this exact path will be looked for. However, if given in the <code>/some/node@attr</code> format, the <em>attr</em> attribute will be retrieved from <em>/some/node</em>, and its value will be then assumed to be the "true" path.</p> <p><em>enumeration</em> - stores a reference of a Java class containing constants or an <em>Enum</em>. This property has a lower priority than <em>value</em>, therefore, if both are set, only <em>value</em> will be taken into account.</p> <p><em>textMember</em> - if specified, defines the attribute of a JCR node or a public method/field name of an Enum to be rendered as RadioButton's or Select's <em>label</em>. <br>Defaults are the <em>"jcr:title"</em> attribute for a JCR node and the <em>.name()</em> method of an Enum class;</p> <p><em>valueMember</em> - if specified, defines the attribute of a JCR node or a public method name of an Enum class to be rendered as RadioButton's or Select's <em>value</em>. <br>If the reserved token <code>@name</code> is specified, the node name will be used for value. <br>If <code>@id</code> is specified, the <em>tag node name with tag namespace</em> (for a <em>cq:Tag</em> node) or a node name (otherwise) will be used as the value. This is particularly useful for tag listings. <br>Default is the <em>"value"</em> attribute for ordinary JCR nodes, <em>.toString()</em> method for an Enum class and the node name for tags;</p> <p><em>attributeMembers</em> - if specified, defines one or more attributes of a node or public method names of an Enum class to be rendered as HTML attributes of the corresponding Granite UI entities. For example, <code>attributeMembers = "some-jcr-attribute"</code> will be rendered as <code>&lt;coral-select-item data-some-jcr-attribute="literal_value_of_this_attribute"&gt;</code> in HTML;</p> <p><em>attributes</em> - if specified, defines one or more static values to be rendered as HTML attributes of the corresponding Granite UI entities. For example, <code>attributes = "some-attribute:some-value"</code> argument will be rendered as <code>&lt;coral-select-item data-some-attribute="some-value"&gt;</code> in HTML. <br>Each attribute must consist of a key and a value separated with colon (<code>:</code>). If a key or a value itself must contain a colon, it can be escaped with <code>\</code>.</p> <p><em>textTransform</em> - if specified, defines the way the <u>label</u> will be transformed before rendering;</p> <p><em>valueTransform</em> - if specified, defines the way the <u>value</u> will be transformed before rendering;</p> <p><em>isFallback</em> - determines that the current <code>@OptionSource</code> is only used if other option source entries yielded no results. It is also used if it is the only option source. This option is useful, e.g., when you have a component with an authorable path to an option source. As the component is just created, the path will probably be empty. But still, there will be a possibility to display some options retrieved via the fallback source.</p> <h2 id="working-with-http-endpoints">Working with HTTP endpoints</h2> <p>Apart from a JCR path, <code>@OptionSource</code> allows specifying a common network URL (note: must be a complete URL string parseable with <code>new URL("...")</code>. The content reached via the URL is expected to be a JSON entity. A JSON array becomes the list of options. A JSON node that has children produces the list of options from the enumeration of child nodes as well much the same way as a JCR resource with children.</p> <p>If the JSON structure is such that the required array is nested deeper than the "root" node, you can add a "path" within the url like <code>http://acme.com/apis/sample.json/internal/path</code> The "path" is defined similar to a Sling suffix: it is the trailing part of the URL after the <em>.json/</em> extension.</p> <p>There is the possibility to add authentication info to the URL like in the following example: <code>http://admin:admin@localhost:4502/my/service.json</code>. The authentication info is converted into a Basic auth request header and sent with the request. This feature is mainly for the testing and debugging purposes. You should not use it when calling a 3rd-party API.</p> <h4 id="working-with-enums">Working with Enums</h4> <p><code>@OptionSource</code> supports usage of Java enums as well as ordinary Java classes that contain a collection of constants. Take a look at the example below:</p> <pre><code class="language-java">
<span class="token annotation punctuation">@AemComponent</span><span class="token punctuation">(</span>
    path <span class="token operator">=</span> <span class="token string">"path/to/my/component"</span><span class="token punctuation">,</span>
    title <span class="token operator">=</span> <span class="token string">"My AEM Component"</span>
<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Dialog</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@DialogField</span>
    <span class="token annotation punctuation">@RadioGroup</span><span class="token punctuation">(</span>
        buttonProvider <span class="token operator">=</span> <span class="token annotation punctuation">@OptionProvider</span><span class="token punctuation">(</span>
                <span class="token annotation punctuation">@OptionSource</span><span class="token punctuation">(</span>
                        enumeration <span class="token operator">=</span> <span class="token class-name">MyEnum</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
                        valueMember<span class="token operator">=</span><span class="token string">"getInteger"</span><span class="token punctuation">,</span>
                        attributeMembers<span class="token operator">=</span><span class="token string">"toString"</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    <span class="token class-name">String</span> radio<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">MyEnum</span> <span class="token punctuation">{</span>
    <span class="token constant">FIRST</span><span class="token punctuation">,</span> <span class="token constant">SECOND</span><span class="token punctuation">,</span> <span class="token constant">THIRD</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>By default, <code>@OptionProvider</code> uses the return value of the <code>.name()</code> method as the text source, and the value of the <code>.toString()</code> as the source for values. No Granite attributes are added by default.</p> <p>You can redefine this via the <em>textMember</em>, <em>valueMember</em>, and <em>attributeMembers</em> properties. E.g. if the enum you want to use has the <em>.getInteger()</em> method, you may specify it like <code>@OptionSource(enumeration = MyEnum.class, valueMember="getInteger")</code>. Besides, you can, for example, ensure that the value of <em>.toString()</em> is rendered as an HTML attribute by specifying <code>attributeMembers="toString"</code>.</p> <h2 id="working-with-java-classes-holding-constants">Working with Java classes holding constants</h2> <p>Apart from an enum, you can make an "ordinary" Java class work as the source of options if it contains <code>public static final</code> fields. Names of such fields will become option titles, and the stringified values (<code>String.valueOf(MY_CONSTANT)</code>) will become option values. You are able to select only some of the available fields with <code>@OptionSource(exclude=...)</code>.</p> <p>More interestingly, there is a way to "merge" constants into pairs in the way that one constant will manifest an option title and another - the value. Indeed, many AEM constants classes follow this pattern:</p> <pre><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ColorConstants</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">LABEL_RED</span> <span class="token operator">=</span> <span class="token string">"Red"</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">VALUE_RED</span> <span class="token operator">=</span> <span class="token string">"#ff0000"</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">LABEL_GREEN</span> <span class="token operator">=</span> <span class="token string">"Green"</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">VALUE_GREEN</span> <span class="token operator">=</span> <span class="token string">"#00ff00"</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">BACKGROUND_NAME_BLACK</span> <span class="token operator">=</span> <span class="token string">"Black"</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">BACKGROUND_VALUE_BLACK</span> <span class="token operator">=</span> <span class="token string">"#000"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <p>To handle that pattern, you may reuse the <em>textMember</em> and <em>valueMember</em> in a bit unusual way. Think of them as not just literals but masks. E.g., the following code:</p> <pre><code>@DialogField
@Select(
    optionProvider = @OptionProvider(
            @OptionSource(
                    enumeration = ColorConstants.class,
                    textMember="LABEL_*",
                    valueMember="VALUE_*")
    )
)
String colors;
</code></pre> <p>This code will make <code>@OptionProvider</code> look for all the constants whose names match the <em>"LABEL_xxxx"</em> pattern and then for those that follow <em>"VALUE_xxxx"</em>. The subsets of constants are merged: "red" goes to "red", etc. In this particular case we receive a list of two option: <code>Red:#ff0000</code> and <code>Green:#00ff00</code>.</p> <p>Note that the "backgrounds" are not included in the list, as they do not correspond to the provided mask. You can introduce a separate <em>Select</em>, this time bor backgrounds, and populate it with <code>@OptionSource(enumeration = ColorConstants.class, textMember="BACKGROUND_NAME_*", valueMember="BACKGROUND_VALUE_*")</code>.</p> <h2 id="dynamic-option-change">Dynamic option change</h2> <p>Because an <code>@OptionProvider</code> supports <em>path references</em> apart from regular paths, the setting that says "where to look for the path" can be stored in a dialog field other than the one that actually deals with paths.</p> <p>Therefore, it must be possible to dynamically respond to a <em>path reference</em> change. In the real world, it may look like the following. Imagine there is a dialog field (say, a path picker) that allows you to select a data source (say, an EToolbox List). Below is a select dropdown with options coming from the Exadel Toolbox List selected in the above path picker.</p> <p>Here's how it may look in Java code:</p> <pre><code class="language-java"><span class="token annotation punctuation">@AemComponent</span><span class="token punctuation">(</span>
        path <span class="token operator">=</span> <span class="token string">"path/to/my/component"</span><span class="token punctuation">,</span>
        title <span class="token operator">=</span> <span class="token string">"My AEM Component"</span>
<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Dialog</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">PATH_REFERENCE</span> <span class="token operator">=</span> <span class="token string">"@path"</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@DialogField</span><span class="token punctuation">(</span>label <span class="token operator">=</span> <span class="token string">"Select option list"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@PathField</span><span class="token punctuation">(</span>rootPath <span class="token operator">=</span> <span class="token string">"/etc/tags"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@DependsOnRef</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> path<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@DialogField</span><span class="token punctuation">(</span>label <span class="token operator">=</span> <span class="token string">"Select option"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span>optionProvider <span class="token operator">=</span> <span class="token annotation punctuation">@OptionProvider</span><span class="token punctuation">(</span><span class="token annotation punctuation">@OptionSource</span><span class="token punctuation">(</span><span class="token constant">PATH_REFERENCE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// @path refers to the attribute named "path" in the same JCR node</span>
    <span class="token annotation punctuation">@DependsOn</span><span class="token punctuation">(</span>
        query <span class="token operator">=</span> <span class="token constant">PATH_REFERENCE</span><span class="token punctuation">,</span>
        action <span class="token operator">=</span> <span class="token class-name">DependsOnActions</span><span class="token punctuation">.</span><span class="token constant">UPDATE_OPTIONS</span><span class="token punctuation">,</span>
        params <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@DependsOnParam</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"sorted"</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">"true"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token annotation punctuation">@DependsOnParam</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"append"</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">"None:none"</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> selectedOption<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <p>The facility that makes it possible to dynamically update selectable options is the <em>DependsOn</em> action <em>"update-options"</em> (see more on DependsOn actions <a href="/content/dev-tools/depends-on/api">here</a>). It accepts any of the conventional <em>OptionProvider</em> params described above in its <code>params</code> collection.</p> <hr> <h2 id="see-also" class="h3">See also</h2> <ul> <li><a href="/content/dev-tools/depends-on/introduction">Programming dynamic dialog behavior: DependsOn plugin client library</a></li> </ul> </div> </main> <esl-scrollbar target="::prev" class="main-scroll"></esl-scrollbar> <div class="header-shadow"></div> </div> <script src="/bundles/site.js"></script>   </body>