<head> <title>Customization</title> <link rel="canonical" href="https://exadel-ink.github.io/content/dev-tools/component-management/customizing-toolkit"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <link rel="icon" type="image/png" href="/etoolbox-authoring-kit/assets/logo-64x64.png"> <link rel="stylesheet" type="text/css" href="/etoolbox-authoring-kit/bundles/localdev.css"> </head> <body> <div class="page sidebar-layout"> <header class="header"> <nav class="header-container container"> <a class="header-link header-logo fill-light logo-animated" href="/etoolbox-authoring-kit/" aria-label="landing page"> <svg width="38" height="38" viewBox="0 0 38 38" fill="none" xmlns="http://www.w3.org/2000/svg"> <g clip-path="url(#clip0_60_1115)"> <path fill-rule="evenodd" clip-rule="evenodd" d="M23.7024 17.967C23.7939 18.133 23.9176 18.2791 24.0663 18.3968C24.215 18.5145 24.3856 18.6013 24.5683 18.6522C24.7509 18.7031 24.9419 18.7171 25.13 18.6933C25.3181 18.6695 25.4995 18.6085 25.6638 18.5137C25.828 18.4189 25.9717 18.2924 26.0864 18.1414C26.2011 17.9905 26.2846 17.8182 26.3319 17.6346C26.3792 17.4509 26.3894 17.2598 26.362 17.0721C26.3345 16.8845 26.2699 16.7043 26.1719 16.542L20.3532 6.46338C20.2191 6.22856 20.0201 6.03746 19.7801 5.91303C19.5401 5.7886 19.2692 5.73615 19 5.76197C18.7311 5.73883 18.4611 5.79245 18.2214 5.9166C17.9818 6.04076 17.7822 6.23036 17.646 6.46338L6.95821 24.973C6.86465 25.1352 6.80395 25.3143 6.77958 25.5C6.75521 25.6856 6.76765 25.8743 6.81619 26.0551C6.86473 26.236 6.94842 26.4055 7.06248 26.554C7.17654 26.7026 7.31873 26.8272 7.48094 26.9207C7.64315 27.0143 7.8222 27.075 8.00787 27.0994C8.19354 27.1237 8.38219 27.1113 8.56306 27.0627C8.74392 27.0142 8.91345 26.9305 9.06197 26.8165C9.21048 26.7024 9.33508 26.5602 9.42865 26.398L19 9.82055L23.7024 17.967Z" fill="#0082CA"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M31.0418 24.8666L28.8082 21.0058C28.6574 20.7407 28.4242 20.5321 28.144 20.4117C27.9168 20.2661 27.653 20.188 27.3832 20.1865H15.7457C15.3678 20.1865 15.0053 20.3366 14.7381 20.6038C14.4709 20.8711 14.3207 21.2335 14.3207 21.6114C14.3207 21.9894 14.4709 22.3518 14.7381 22.6191C15.0053 22.8863 15.3678 23.0364 15.7457 23.0364H26.6969L28.5732 26.2898C28.7696 26.6016 29.0791 26.8252 29.4367 26.9137C29.7944 27.0023 30.1725 26.949 30.4917 26.765C30.8109 26.5809 31.0465 26.2805 31.149 25.9266C31.2516 25.5727 31.2132 25.1928 31.0418 24.8666Z" fill="#0082CA"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M38 19C38 8.50287 29.4971 0 19 0C8.50287 0 0 8.50287 0 19C0 29.4971 8.50198 38 19 38C21.814 38.0041 24.5932 37.3785 27.134 36.1689C26.9108 36.0531 26.7227 35.8797 26.5891 35.6667C26.4555 35.4538 26.3812 35.2089 26.3741 34.9576C24.0664 36.0219 21.5554 36.5728 19.0142 36.5724C9.31246 36.5724 1.43917 28.7 1.43917 18.9973C1.43917 9.29472 9.29827 1.42498 19 1.42498C28.7017 1.42498 36.575 9.30093 36.575 19C36.5827 22.5945 35.4792 26.1035 33.4156 29.0467C33.5856 29.179 33.7232 29.3483 33.8179 29.5417C33.9127 29.7352 33.9622 29.9477 33.9627 30.1631V30.7093C36.5838 27.3696 38.0058 23.2455 38 19Z" fill="#0082CA"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M32.3001 29.6878H28.0269C27.8377 29.6878 27.6563 29.7629 27.5225 29.8967C27.3887 30.0305 27.3135 30.2119 27.3135 30.4011C27.3135 30.5903 27.3887 30.7718 27.5225 30.9056C27.6563 31.0394 27.8377 31.1145 28.0269 31.1145H31.5889V32.3019C31.5889 32.4908 31.664 32.672 31.7976 32.8057C31.9312 32.9393 32.1124 33.0143 32.3014 33.0143C32.4904 33.0143 32.6716 32.9393 32.8052 32.8057C32.9388 32.672 33.0139 32.4908 33.0139 32.3019V30.4051C33.0142 30.3111 32.996 30.218 32.9603 30.131C32.9246 30.0441 32.8721 29.965 32.8058 29.8984C32.7395 29.8317 32.6607 29.7788 32.5739 29.7427C32.4871 29.7066 32.3941 29.6879 32.3001 29.6878Z" fill="#0082CA"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M32.0624 33.9627H28.7363V32.5377C28.7363 32.3488 28.6613 32.1676 28.5276 32.0339C28.394 31.9003 28.2128 31.8253 28.0238 31.8253C27.8349 31.8253 27.6536 31.9003 27.52 32.0339C27.3864 32.1676 27.3113 32.3488 27.3113 32.5377V34.6757C27.3127 34.8634 27.3879 35.043 27.5207 35.1757C27.6534 35.3085 27.833 35.3836 28.0207 35.385H32.058C32.247 35.385 32.4282 35.31 32.5618 35.1764C32.6954 35.0427 32.7705 34.8615 32.7705 34.6725C32.7705 34.4836 32.6954 34.3024 32.5618 34.1687C32.4282 34.0351 32.247 33.9601 32.058 33.9601L32.0624 33.9627Z" fill="#0082CA"></path> </g> <defs> <clipPath id="clip0_60_1115"> <rect width="38" height="38" fill="white"></rect> </clipPath> </defs> </svg> <span class="header-long-name">Exadel Authoring Kit for AEM</span> </a> <ul class="header-links"> <li class="header-li"> <a class="header-link" href=".">Manuals</a> </li> <li class="header-li"> <a class="header-link" href="" target="_blank">API Docs</a> </li> <li class="header-li"> <a class="header-link" href="" target="_blank">Blog</a> </li> <li class="header-li"> <a class="header-link" href="https://github.com/exadel-inc/etoolbox-authoring-kit" target="_blank"> <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M10.6666 14.6667V12.0867C10.6916 11.7688 10.6486 11.4492 10.5406 11.1492C10.4325 10.8492 10.2619 10.5756 10.0399 10.3467C12.1333 10.1133 14.3333 9.32 14.3333 5.68C14.3331 4.74922 13.975 3.85413 13.3333 3.18C13.6372 2.36567 13.6157 1.46557 13.2733 0.666666C13.2733 0.666666 12.4866 0.433332 10.6666 1.65333C9.13859 1.23921 7.52791 1.23921 5.99992 1.65333C4.17992 0.433332 3.39325 0.666666 3.39325 0.666666C3.05084 1.46557 3.02935 2.36567 3.33325 3.18C2.68667 3.85913 2.32827 4.76231 2.33325 5.7C2.33325 9.31333 4.53325 10.1067 6.62659 10.3667C6.40725 10.5933 6.23809 10.8636 6.13012 11.1599C6.02215 11.4563 5.97779 11.772 5.99992 12.0867V14.6667" fill="#65BDEA"></path> <path d="M5.99992 12.6667C2.66659 13.6667 2.66659 11 1.33325 10.6667M10.6666 14.6667V12.0867C10.6916 11.7688 10.6486 11.4492 10.5406 11.1492C10.4325 10.8492 10.2619 10.5756 10.0399 10.3467C12.1333 10.1133 14.3333 9.32 14.3333 5.68C14.3331 4.74922 13.975 3.85413 13.3333 3.18C13.6372 2.36567 13.6157 1.46557 13.2733 0.666666C13.2733 0.666666 12.4866 0.433332 10.6666 1.65333C9.13859 1.23921 7.52791 1.23921 5.99992 1.65333C4.17992 0.433332 3.39325 0.666666 3.39325 0.666666C3.05084 1.46557 3.02935 2.36567 3.33325 3.18C2.68667 3.85913 2.32827 4.76231 2.33325 5.7C2.33325 9.31333 4.53325 10.1067 6.62659 10.3667C6.40725 10.5933 6.23809 10.8636 6.13012 11.1599C6.02215 11.4563 5.97779 11.772 5.99992 12.0867V14.6667H10.6666Z" stroke="#65BDEA" stroke-linecap="round" stroke-linejoin="round"></path> </svg> </a> </li> </ul> <div class="header-btn"><a href="." class="btn btn-blue btn-media header-btn-link">Get started</a></div> <div class="header-utility"> <esl-trigger class="header-hamburger" target="#sidebar" aria-label="navigation menu"></esl-trigger> </div> </nav> </header> <esl-d-sidebar id="sidebar" class="open" aria-label="Site Navigation"> <nav class="sidebar-nav"> <a class="sidebar-heading" href="/etoolbox-authoring-kit/"> <span class="sidebar-logo fill-light"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" xmlns="http://www.w3.org/2000/svg"> <g clip-path="url(#clip0_60_1115)"> <path fill-rule="evenodd" clip-rule="evenodd" d="M23.7024 17.967C23.7939 18.133 23.9176 18.2791 24.0663 18.3968C24.215 18.5145 24.3856 18.6013 24.5683 18.6522C24.7509 18.7031 24.9419 18.7171 25.13 18.6933C25.3181 18.6695 25.4995 18.6085 25.6638 18.5137C25.828 18.4189 25.9717 18.2924 26.0864 18.1414C26.2011 17.9905 26.2846 17.8182 26.3319 17.6346C26.3792 17.4509 26.3894 17.2598 26.362 17.0721C26.3345 16.8845 26.2699 16.7043 26.1719 16.542L20.3532 6.46338C20.2191 6.22856 20.0201 6.03746 19.7801 5.91303C19.5401 5.7886 19.2692 5.73615 19 5.76197C18.7311 5.73883 18.4611 5.79245 18.2214 5.9166C17.9818 6.04076 17.7822 6.23036 17.646 6.46338L6.95821 24.973C6.86465 25.1352 6.80395 25.3143 6.77958 25.5C6.75521 25.6856 6.76765 25.8743 6.81619 26.0551C6.86473 26.236 6.94842 26.4055 7.06248 26.554C7.17654 26.7026 7.31873 26.8272 7.48094 26.9207C7.64315 27.0143 7.8222 27.075 8.00787 27.0994C8.19354 27.1237 8.38219 27.1113 8.56306 27.0627C8.74392 27.0142 8.91345 26.9305 9.06197 26.8165C9.21048 26.7024 9.33508 26.5602 9.42865 26.398L19 9.82055L23.7024 17.967Z" fill="white"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M31.0418 24.8666L28.8082 21.0058C28.6574 20.7407 28.4242 20.5321 28.144 20.4117C27.9168 20.2661 27.653 20.188 27.3832 20.1865H15.7457C15.3678 20.1865 15.0053 20.3366 14.7381 20.6038C14.4709 20.8711 14.3207 21.2335 14.3207 21.6114C14.3207 21.9894 14.4709 22.3518 14.7381 22.6191C15.0053 22.8863 15.3678 23.0364 15.7457 23.0364H26.6969L28.5732 26.2898C28.7696 26.6016 29.0791 26.8252 29.4367 26.9137C29.7944 27.0023 30.1725 26.949 30.4917 26.765C30.8109 26.5809 31.0465 26.2805 31.149 25.9266C31.2516 25.5727 31.2132 25.1928 31.0418 24.8666Z" fill="white"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M38 19C38 8.50287 29.4971 0 19 0C8.50287 0 0 8.50287 0 19C0 29.4971 8.50198 38 19 38C21.814 38.0041 24.5932 37.3785 27.134 36.1689C26.9108 36.0531 26.7227 35.8797 26.5891 35.6667C26.4555 35.4538 26.3812 35.2089 26.3741 34.9576C24.0664 36.0219 21.5554 36.5728 19.0142 36.5724C9.31246 36.5724 1.43917 28.7 1.43917 18.9973C1.43917 9.29472 9.29827 1.42498 19 1.42498C28.7017 1.42498 36.575 9.30093 36.575 19C36.5827 22.5945 35.4792 26.1035 33.4156 29.0467C33.5856 29.179 33.7232 29.3483 33.8179 29.5417C33.9127 29.7352 33.9622 29.9477 33.9627 30.1631V30.7093C36.5838 27.3696 38.0058 23.2455 38 19Z" fill="white"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M32.3001 29.6878H28.0269C27.8377 29.6878 27.6563 29.7629 27.5225 29.8967C27.3887 30.0305 27.3135 30.2119 27.3135 30.4011C27.3135 30.5903 27.3887 30.7718 27.5225 30.9056C27.6563 31.0394 27.8377 31.1145 28.0269 31.1145H31.5889V32.3019C31.5889 32.4908 31.664 32.672 31.7976 32.8057C31.9312 32.9393 32.1124 33.0143 32.3014 33.0143C32.4904 33.0143 32.6716 32.9393 32.8052 32.8057C32.9388 32.672 33.0139 32.4908 33.0139 32.3019V30.4051C33.0142 30.3111 32.996 30.218 32.9603 30.131C32.9246 30.0441 32.8721 29.965 32.8058 29.8984C32.7395 29.8317 32.6607 29.7788 32.5739 29.7427C32.4871 29.7066 32.3941 29.6879 32.3001 29.6878Z" fill="white"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M32.0624 33.9627H28.7363V32.5377C28.7363 32.3488 28.6613 32.1676 28.5276 32.0339C28.394 31.9003 28.2128 31.8253 28.0238 31.8253C27.8349 31.8253 27.6536 31.9003 27.52 32.0339C27.3864 32.1676 27.3113 32.3488 27.3113 32.5377V34.6757C27.3127 34.8634 27.3879 35.043 27.5207 35.1757C27.6534 35.3085 27.833 35.3836 28.0207 35.385H32.058C32.247 35.385 32.4282 35.31 32.5618 35.1764C32.6954 35.0427 32.7705 34.8615 32.7705 34.6725C32.7705 34.4836 32.6954 34.3024 32.5618 34.1687C32.4282 34.0351 32.247 33.9601 32.058 33.9601L32.0624 33.9627Z" fill="white"></path> </g> <defs> <clipPath id="clip0_60_1115"> <rect width="38" height="38" fill="white"></rect> </clipPath> </defs> </svg> </span> <span class="sidebar-title">EXADEL AUTHORING <br> KIT FOR AEM</span> </a> <div class="sidebar-content"> <ul class="sidebar-nav-list esl-scrollable-content"> <li class="sidebar-nav-item"> <div class="sidebar-nav-item-heading"> <esl-trigger class="sidebar-nav-item-trigger sidebar-nav-item-arrow" target="::parent::next"> Getting Started </esl-trigger> </div> <esl-panel id="sidebar-getting-started-menu" class="sidebar-nav-secondary" group="esl-nav "> <ul class="sidebar-nav-secondary-list"> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/getting-started/installation/"> Installation </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/getting-started/common-use-cases/"> Common Use Cases </a> </li> </ul> </esl-panel> </li> <li class="sidebar-nav-item"> <div class="sidebar-nav-item-heading active"> <esl-trigger class="sidebar-nav-item-trigger sidebar-nav-item-arrow" target="::parent::next" active=""> Developer Tools </esl-trigger> </div> <esl-panel id="sidebar-dev-tools-menu" class="sidebar-nav-secondary open" data-open="" group="esl-nav "> <ul class="sidebar-nav-secondary-list"> <li class="sidebar-nav-secondary-item sidebar-secondary-nav-item-children"> <div class="sidebar-nav-item-heading active"> <esl-trigger class="sidebar-nav-item-trigger sidebar-nav-item-arrow" target="::parent::next" active=""> Component Management </esl-trigger> </div> <esl-panel id="sidebar-component-management-menu" class="sidebar-nav-secondary open" data-open="" group=" component-management"> <ul class="sidebar-nav-secondary-list"> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/component-management/component-structure/"> Component Structure </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/component-management/dialog-layout/"> Dialog Layout </a> </li> <li class="sidebar-nav-secondary-item sidebar-secondary-nav-item-children"> <div class="sidebar-nav-item-heading"> <esl-trigger class="sidebar-nav-item-trigger sidebar-nav-item-arrow" target="::parent::next"> Dialog Fields </esl-trigger> </div> <esl-panel id="sidebar-dialog-fields-menu" class="sidebar-nav-secondary" group=" dialog-fields"> <ul class="sidebar-nav-secondary-list"> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/component-management/dialog-fields/dialog-field/"> Dialog Field </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/component-management/dialog-fields/widgets/"> Widgets (A-Z) </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/component-management/dialog-fields/configuring-rte/"> Configuring RTE </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/component-management/dialog-fields/configuring-fieldset/"> Configuring Fieldset </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/component-management/dialog-fields/configuring-multifield/"> Configuring Multifield </a> </li> </ul> </esl-panel> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/component-management/additional-properties/"> Additional Properties </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/component-management/reusing-code/"> Reusing Code </a> </li> <li class="sidebar-nav-secondary-item active" aria-selected="true"> <a class="sidebar-nav-secondary-link" aria-current="page" href="/etoolbox-authoring-kit/content/dev-tools/component-management/customizing-toolkit/"> Customization </a> </li> </ul> </esl-panel> </li> <li class="sidebar-nav-secondary-item sidebar-secondary-nav-item-children"> <div class="sidebar-nav-item-heading"> <esl-trigger class="sidebar-nav-item-trigger sidebar-nav-item-arrow" target="::parent::next"> DependsOn </esl-trigger> </div> <esl-panel id="sidebar-depends-on-menu" class="sidebar-nav-secondary" group=" depends-on"> <ul class="sidebar-nav-secondary-list"> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/depends-on/introduction/"> Introduction </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/depends-on/usage/"> Usage </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/depends-on/api/"> API </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/depends-on/examples/"> Examples </a> </li> </ul> </esl-panel> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/option-provider/"> Option Provider </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/injectors/"> Injectors </a> </li> </ul> </esl-panel> </li> <li class="sidebar-nav-item"> <div class="sidebar-nav-item-heading"> <esl-trigger class="sidebar-nav-item-trigger sidebar-nav-item-arrow" target="::parent::next"> Authoring Tools </esl-trigger> </div> <esl-panel id="sidebar-authoring-tools-menu" class="sidebar-nav-secondary" group="esl-nav "> <ul class="sidebar-nav-secondary-list"> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/authoring-tools/etoolbox-lists/"> Etoolbox Lists </a> </li> </ul> </esl-panel> </li> </ul> <esl-scrollbar class="sidebar-scrollbar" target="::prev"></esl-scrollbar> </div> </nav> </esl-d-sidebar> <main class="esl-scrollable-content"> <div class="content container markdown-container pt-4"> <h2 id="customizing-the-toolkit-to-your-needs">Customizing the ToolKit to your needs</h2> <h3 id="custom-annotations.-annotation-scopes">Custom annotations. Annotation scopes</h3> <p>When creating markup for the Granite UI, the ToolKit handles data from the project's source code. Often it comes from Java annotations like <code>@AemComponent</code>, <code>@EditConfig</code>, or, e.g., <code>@DatePicker</code>.</p> <p>You can create such annotations yourself. In the most basic case, you only need to declare an arbitrary annotation and attach the <code>@AnnotationRendering</code> meta-annotation.</p> <p><code>@AnnotationRendering</code> allows specifying what properties will be automatically mapped to the underlying node's attributes and in what <em>scope</em>.</p> <h4 id="custom-annotation-scope">Custom annotation scope</h4> <p>The notion of <em>scope</em> refers to the region of a component in which the current annotation/handler is effective. The most common scopes are enumerated in the <code>Scopes</code> class. These are the component scope (roughly maps to the <em>.content.xml</em> file in a component's folder as we see in the project source files), <em>&lt;cq:dialog&gt;</em>, <em>&lt;cq:design_dialog&gt;</em>, <em>&lt;cq:editConfig&gt;</em>, <em>&lt;cq:childEditConfig&gt;</em>, <em>&lt;cq:htmlTag&gt;</em>. There can be custom scopes for specific cases. Whenever the scope is not specified, the default (or "all-included") scope is assumed.</p> <p>Consider the following example:</p> <pre><code class="language-java">
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span>TYPE<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>
<span class="token annotation punctuation">@AnnotationRendering</span><span class="token punctuation">(</span>
    scope <span class="token operator">=</span> <span class="token class-name">Scopes</span><span class="token punctuation">.</span>CQ_DIALOG<span class="token punctuation">,</span>
    prefix <span class="token operator">=</span> <span class="token string">"some:"</span>
<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">CustomDialogAnnotation</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> <span class="token function">field1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">""</span><span class="token punctuation">;</span>

    <span class="token keyword">long</span> <span class="token function">field2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">boolean</span> <span class="token function">field3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">field4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@AemComponent</span><span class="token punctuation">(</span>
    path <span class="token operator">=</span> <span class="token string">"path/to/my/component"</span><span class="token punctuation">,</span>
    title <span class="token operator">=</span> <span class="token string">"My AEM Component"</span>
<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Dialog</span>
<span class="token annotation punctuation">@CustomDialogAnnotation</span><span class="token punctuation">(</span>
    field1 <span class="token operator">=</span> <span class="token string">"value1"</span><span class="token punctuation">,</span>
    field2 <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">,</span>
    field3 <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    field4 <span class="token operator">=</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span>
<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token punctuation">{</span><span class="token comment">/* ... */</span>
<span class="token punctuation">}</span>
</code></pre> <p>In this sample, the ToolKit essentially creates two Granite nodes: one that would be represented by <em>.content.xml</em> in the project's source code and one represented by <em>_cq_dialog.xml</em>. The former is based on <code>@AemComponent</code> and the latter on <code>@Dialog</code> because this is the default functionality of the ToolKit.</p> <p>The <code>@CustomDialogAnnotation</code> will also affect the Granite UI markup. Its <code>@AnnotationRendering</code> meta-annotation determines that it will affect only the <em>_cq_dialog.xml</em> as follows from <code>scope = Scopes.CQ_DIALOG</code> (be aware that the <em>scope</em> property can also accept an array of values).</p> <p>You can omit the <em>scope</em> property. Then the appropriate scope will be decided on from other annotations attached to the current class. That is, if the class is <code>@Dialog</code>-annotated and a custom annotation is missing a <em>scope</em>, it is assumed that the custom annotation is also bound to the dialog scope. But if the class has its <code>@EditConfig</code> specified but no <code>@Dialog</code>, it is assumed that the custom annotation is within the <em>&lt;cq:editConfig&gt;</em> scope, etc.</p> <h4 id="how-to-control-the-automapping">How to control the automapping</h4> <p>From <code>@CustomDialogAnnotation</code>, the following property values will be automatically mapped: <em>field1</em>, <em>field2</em>, and <em>field3</em>. That is because they have the "mappable" property type. Automatic mapping works for <code>string</code>s (and string arrays); <code>long</code>s (and long arrays), <code>double</code>s (and double arrays), <code>boolean</code>s (and boolean arrays); <code>enum</code> types (ane enum arrays). However, it does not work for <code>Class&lt;?&gt;</code>-typed properties or annotation types.</p> <p>There is a way to restrict automatic mapping to particular properties by specifying them in the following way: <code>@AnnotationRendering(properties = {"field1", "field2"})</code>. You can also turn off automapping completely without removing <code>@AnnotationRendering</code>. To do this you specify <code>@AnnotationRendering(value = {})</code> or <code>@AnnotationRendering(value = "none")</code>.</p> <p>You can also set a prefix for all the properties rendered via the current annotation. Just use <code>@AnnotationRendering(prefix="some_value")</code>.</p> <h4 id="propertyrendering">@PropertyRendering</h4> <p>More settings for the mapping flow can be defined at the individual property level. See the following example:</p> <pre><code class="language-java">
<span class="token annotation punctuation">@AnnotationRendering</span><span class="token punctuation">(</span>properties <span class="token operator">=</span> <span class="token string">"all"</span><span class="token punctuation">)</span> <span class="token comment">// "all" is implied by default but added here for readability</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">CustomAnnotation</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@PropertyRendering</span><span class="token punctuation">(</span>
        name <span class="token operator">=</span> <span class="token string">"some:text"</span><span class="token punctuation">,</span>
        scope <span class="token operator">=</span> <span class="token class-name">Scopes</span><span class="token punctuation">.</span>CQ_DIALOG<span class="token punctuation">,</span>
        allowBlank <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        transform <span class="token operator">=</span> <span class="token class-name">StringTransformation</span><span class="token punctuation">.</span>CAPITALIZE
    <span class="token punctuation">)</span>
    <span class="token class-name">String</span> <span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@PropertyRendering</span><span class="token punctuation">(</span>
        name <span class="token operator">=</span> <span class="token string">"some:checked"</span><span class="token punctuation">,</span>
        ignoreValues <span class="token operator">=</span> <span class="token string">"false"</span><span class="token punctuation">,</span>
        valueType <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">boolean</span> <span class="token function">checked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <p><em>name</em> is used to alter the attribute's name in JCR (in particular, to use a prefixed name or to prepend a namespace). On the contrary,<em>ignorePrefix</em> allows for stripping off a name prefix if it was defined at an upper level (e.g., in the FieldSet).</p> <p><em>scope</em> can be specified to define what JCR node (XML file) will contain this particular property. Useful to distribute properties between, e.g., <em>_content.xml</em> and <em>_cq_dialog.xml</em> files.</p> <p><em>allowBlank</em> determines that even empty or blank property values will be rendered (default behavior is to skip them). On the contrary, <em>ignoreValues</em> ensures that a particular non-blank value (or an array of values) will be skipped as the negligible default. <em>ignoreValues</em> accepts strings like <code>"42"</code> or <code>"false"</code> to ensure that even a numeric or boolean value matching the string can be skipped.</p> <p><em>transform</em> is primarily useful for <code>enum</code>-typed arguments. It provides a way to, for example, render Java enum values in lowercase, which is the standard for Granite settings. Important: if an enum value is set to be skipped via <em>ignoreValues</em>, specify the already transformed writing and not the original.</p> <p><em>valueType</em> allows you to control how a value is stored in JCR. For example, a value of type <code>boolean</code> would be by default rendered as <code>{Boolean}true</code> or <code>{Boolean}false</code>. If you need the type hint skipped, make the ToolKit perceive the value as a string by specifying <code>valueType = String.class</code>.</p> <h3 id="custom-handlers">Custom handlers</h3> <p>ToolKit annotations are rendered with <em>Handlers</em> (even an automatically mapped annotation is processed via an undercover "automapping handler"). All the out-of-box annotations are supplemented with bundled handlers, but you can declare custom ones as well.</p> <p>Here is an example of how a custom handler can look:</p> <pre><code class="language-java">
<span class="token annotation punctuation">@Handles</span><span class="token punctuation">(</span>
    value <span class="token operator">=</span> <span class="token class-name">MultiField</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
    scope <span class="token operator">=</span> <span class="token class-name">Scopes</span><span class="token punctuation">.</span>CQ_DIALOG<span class="token punctuation">,</span>
    before <span class="token operator">=</span> <span class="token class-name">MyCustomHandler</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
    after <span class="token operator">=</span> <span class="token class-name">MyAnotherCustomHandler</span><span class="token punctuation">.</span><span class="token keyword">class</span>
<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">CustomMultifieldHandler</span> <span class="token keyword">implements</span> <span class="token class-name">Handler</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">accept</span><span class="token punctuation">(</span><span class="token class-name">Source</span> source<span class="token punctuation">,</span> <span class="token class-name">Target</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        target<span class="token punctuation">.</span><span class="token function">attribute</span><span class="token punctuation">(</span><span class="token string">"multifieldSpecial"</span><span class="token punctuation">,</span> <span class="token string">"This is added to MultiFields"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>Every custom handler is characterized by the following features:</p> <ol> <li>Marked with the <code>@Handles</code> annotation;</li> <li>Implements <code>Handler</code>;</li> <li>Overrides the <code>accept(Source, Target)</code> method in which the payload logic is run.</li> </ol> <p>Usually, the ToolKit initializes one instance of every handler and manages it as a <em>singleton</em>, so a developer is expected to avoid assigning handler-wide <em>states</em>. All the logic should be processed within the <code>accept(Source, Target)</code>method or in methods called from the latter.</p> <h4 id="handles">@Handles</h4> <p><code>@Handles</code> is the marker of a handler. This annotation exposes the following properties.</p> <p><em>value</em> is a single <code>Class</code> reference or an array of classes. The classes are indeed the annotation types. This setting determines what annotations of a component class or its member will trigger the execution of the current handler.</p> <p>There is no restriction regarding what annotations can be handled; built-in ones (then the current handler will provide some "additional" handling); custom ones; and even third-party annotations are covered. A custom annotation doesn't necessarily have to be marked with something like <code>@AnnotationRendering</code>; the absence of the meta-annotation would only lead to the automapping not being performed.</p> <p><em>scope</em> is an optional property determining in what <a href="#custom-annotation-scope">scope</a> this handler will operate. If not specified, the scope will be decided on by querying for the <em>scope</em> of the handled annotation. The default is all applicable scopes.</p> <p><em>before</em> and <em>after</em> parameters allow for arranging the sequence of handling. If neither is specified, the handlers are executed in the following sequence: first the built-in handlers hooked to this annotation, then custom handlers, in alphabetical order by name.</p> <h4 id="source-object">Source object</h4> <p>The first argument of a handler's <code>accept</code> method is the <a href="https://javadoc.io/doc/com.exadel.etoolbox/etoolbox-authoring-kit-core/latest/com/exadel/aem/toolkit/api/handlers/Source.html">Source</a>. This is a generic data provider that matches the entity (a Java class or a class member) the handler is called for. If the current handler is invoked due to an annotation attached to a class, the <em>Source</em> represents the class itself. But if the annotation was attached to a method or a field, the <em>Source</em> stands for the underlying member.</p> <p>The <em>Source</em> is further specified by calling the <code>adaptTo()</code> method that accepts the only argument: the adapter type. You can, for example, call <code>source.adaptTo(Annotation[].class)</code> to get the array of annotations attached to the source-reflected class or class member. Also, you can specify a particular annotation like <code>source.adaptTo(DialogField.class)</code>. If the referred annotation is not present, <code>null</code> is returned. To mitigate null pointer management you can call the <code>tryAdaptTo()</code> method that will return an <code>Optional</code> object.</p> <p>There are predefined source adapters. For instance, a source object can be adapted to <code>MemberSource</code> that has several properties specific for member-based sources (refer to this <a href="https://javadoc.io/doc/com.exadel.etoolbox/etoolbox-authoring-kit-core/latest/com/exadel/aem/toolkit/api/handlers/MemberSource.html">javadoc</a> for details).</p> <p>You can create your own adapter that will encapsulate some reasonable logic. See the following code snippet which shows how to virtually turn a ToolKit annotation into a writable Java entity:</p> <pre><code class="language-java">
<span class="token annotation punctuation">@Adapts</span><span class="token punctuation">(</span><span class="token class-name">Source</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token comment">// Indicates the adaptable. For all source adaptations, the value should be "Source"</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WritableDialogField</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">int</span> ranking<span class="token punctuation">;</span>

    <span class="token comment">// Instance constructor *must* be public and accept the only argument - the instance of adaptable</span>
    <span class="token keyword">public</span> <span class="token class-name">WritableDialogField</span><span class="token punctuation">(</span><span class="token class-name">Source</span> source<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>source <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> source<span class="token punctuation">.</span><span class="token function">adaptTo</span><span class="token punctuation">(</span><span class="token class-name">DialogField</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ranking <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">adaptTo</span><span class="token punctuation">(</span><span class="token class-name">DialogField</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ranking<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getRanking</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> ranking<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setRanking</span><span class="token punctuation">(</span><span class="token keyword">int</span> ranking<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ranking <span class="token operator">=</span> ranking<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Handles</span><span class="token punctuation">(</span><span class="token class-name">CustomAnnotation</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomHandler</span> <span class="token keyword">implements</span> <span class="token class-name">Handler</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">accept</span><span class="token punctuation">(</span><span class="token class-name">Source</span> source<span class="token punctuation">,</span> <span class="token class-name">Target</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> ranking <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">adaptTo</span><span class="token punctuation">(</span><span class="token class-name">DialogField</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ranking</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        source<span class="token punctuation">.</span><span class="token function">adaptTo</span><span class="token punctuation">(</span><span class="token class-name">WritableDialogField</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setRanking</span><span class="token punctuation">(</span>ranking <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>Adapter instances are retained for a <em>Source</em> through the handling chain. Therefore, you can assign values to custom adapters and be sure that the same value can be retrieved in, for example, another handler processing some other annotation attached to the same class or class member.</p> <h4 id="target-object">Target object</h4> <p>In a ToolKit's handler, <em>Target</em> stands for an abstraction of rendering a target. Each <em>Target</em> instance represents a future Granite UI entity or a corresponding XML node. It can have its attributes, a parent target, and an ordered collection of child targets (nodes) the same way that Granite/XML nodes do.</p> <p>The ToolKit API is designed in a way to make operation <em>Targets</em> more convenient than operation "bare" XML DOM entities. There are 40+ methods that comprise functional areas such as:</p> <ul> <li>Retrieving/setting of the (tag)name, prefix, and postfix;</li> <li>Retrieving/creating child targets by name or by relative path (multi-segment paths are supported);</li> <li>Traversing the targets tree upward and downward and finding a matching sub- or super-target by criteria;</li> <li>Moving, inserting, or deleting child targets;</li> <li>Setting an attribute to a target;</li> <li>Mapping a "whole" annotation to a target (its properties become the target's attributes);</li> <li>Removing attributes, etc.</li> </ul> <p>Consider the following example:</p> <pre><code class="language-java">
<span class="token annotation punctuation">@Handles</span><span class="token punctuation">(</span><span class="token class-name">CustomAnnotation</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomHandler</span> <span class="token keyword">implements</span> <span class="token class-name">Handler</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">accept</span><span class="token punctuation">(</span><span class="token class-name">Source</span> source<span class="token punctuation">,</span> <span class="token class-name">Target</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> memberName <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        target
            <span class="token punctuation">.</span><span class="token function">attributes</span><span class="token punctuation">(</span>source<span class="token punctuation">.</span><span class="token function">adaptTo</span><span class="token punctuation">(</span><span class="token class-name">DialogField</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// maps all the props of @DialogField to target's attributes</span>
            <span class="token punctuation">.</span><span class="token function">attribute</span><span class="token punctuation">(</span><span class="token string">"processed"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>  <span class="token comment">// assigns a boolean-type attribute</span>
            <span class="token punctuation">.</span><span class="token function">attribute</span><span class="token punctuation">(</span><span class="token string">"sourceName"</span><span class="token punctuation">,</span> memberName<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">createChild</span><span class="token punctuation">(</span><span class="token string">"items"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// creates a child target by name</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            target<span class="token punctuation">.</span><span class="token function">getOrCreateChild</span><span class="token punctuation">(</span><span class="token string">"items/item"</span> <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token comment">// retrieves a child target by relative path</span>
                <span class="token punctuation">.</span><span class="token function">attribute</span><span class="token punctuation">(</span><span class="token string">"ordinal"</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// assigns a numeric attribute</span>
                <span class="token punctuation">.</span><span class="token function">attribute</span><span class="token punctuation">(</span><span class="token string">"intArray"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token keyword">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// assigns an array</span>
                <span class="token punctuation">.</span><span class="token function">createChild</span><span class="token punctuation">(</span><span class="token string">"subitem1"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// returns the parent node of the last processed node</span>
                <span class="token punctuation">.</span><span class="token function">createChild</span><span class="token punctuation">(</span><span class="token string">"subitem2"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">attribute</span><span class="token punctuation">(</span><span class="token string">"dateCreated"</span><span class="token punctuation">,</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>calendar<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// assigns a date</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">Target</span> subitem0 <span class="token operator">=</span> testable<span class="token punctuation">.</span><span class="token function">getTarget</span><span class="token punctuation">(</span><span class="token string">"item0/subitem0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// traverses the target tree</span>
        <span class="token class-name">Target</span> subitem1 <span class="token operator">=</span> subitem0<span class="token punctuation">.</span><span class="token function">getTarget</span><span class="token punctuation">(</span><span class="token string">"../../item0/subitem0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ".." returns a parent target, or else the current one if the parent is null</span>

        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">assertNotNull</span><span class="token punctuation">(</span>testable<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// '..' returns the current node if there's no parent</span>
        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token string">"subitem0"</span><span class="token punctuation">,</span> testable<span class="token punctuation">.</span><span class="token function">getTarget</span><span class="token punctuation">(</span><span class="token string">"item2/subitem2/../../item0/subitem0"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">assertNull</span><span class="token punctuation">(</span>testable<span class="token punctuation">.</span><span class="token function">getTarget</span><span class="token punctuation">(</span><span class="token string">"item2/subitem3/../../item0/subitem0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">assertEquals</span><span class="token punctuation">(</span>TIER_1_CHILD_COUNT <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> testable<span class="token punctuation">.</span><span class="token function">findChildren</span><span class="token punctuation">(</span>t <span class="token operator">-&gt;</span> t<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span>NN_SUBITEM<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> testable<span class="token punctuation">.</span><span class="token function">findChildren</span><span class="token punctuation">(</span>t <span class="token operator">-&gt;</span> t<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span>PN_ORDINAL<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"{Long}1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Target</span> subsubitem <span class="token operator">=</span> testable<span class="token punctuation">.</span><span class="token function">findChild</span><span class="token punctuation">(</span>t <span class="token operator">-&gt;</span> <span class="token operator">!</span>t<span class="token punctuation">.</span><span class="token function">getTarget</span><span class="token punctuation">(</span><span class="token string">"../../.."</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">getTarget</span><span class="token punctuation">(</span><span class="token string">"../.."</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">assertEquals</span><span class="token punctuation">(</span>NN_SUBSUBITEM <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">,</span> subsubitem<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">assertEquals</span><span class="token punctuation">(</span>testable<span class="token punctuation">,</span> subsubitem<span class="token punctuation">.</span><span class="token function">findParent</span><span class="token punctuation">(</span>t <span class="token operator">-&gt;</span> t<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>NN_ROOT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>In this example, the <em>items</em> node is created within the given <em>target</em>. Then <em>items</em> are populated with subnodes, each having the <em>ordinal</em> attribute with the values 1.. 10. Each one will be given two children of its own with the names <em>subitem1</em> and <em>subitem2</em>.</p> <p>The following code would help retrieve a collection of nodes (regardless the nested level), the names of which end with "1":</p> <pre><code>List&lt;Target&gt; firstChildren = currentTarget.findChildren(t -&gt; t.getName().endsWith("1"))
</code></pre> <p>Next is the way to collect all the targets within the target tree that are grandchildren of nodes with the container resource type:</p> <pre><code>List&lt;Target&gt; containerDescendants = currentTarget.findChildren(t -&gt; StringUtils.defaultString(t.getTarget("../..").getAttribute("sling:resourceType")).equals("granite/ui/components/coral/foundation/container"));
</code></pre> <p>Another snippet shows how to retrieve an ancestor with a particular name:</p> <pre><code>Target root = currentTarget.findParent(t -&gt; t.getName().equals("jcr:root"))
</code></pre> <p>There are many more possibilities. For greater detail, see the inline documentation on <a href="https://javadoc.io/doc/com.exadel.etoolbox/etoolbox-authoring-kit-core/latest/com/exadel/aem/toolkit/api/handlers/Target.html">Target</a>.</p> <p>Just like <em>Source</em>, <em>Target</em> is an adaptable entity. By default, <em>Target</em> adapts to <code>DomAdapter</code> with the possibility of being serialized to an XML DOM document. You can apply any custom adapters in the way described in the "Source object" section.</p> <h3 id="debugging-custom-logic">Debugging custom logic</h3> <p>You can debug the ToolKit's plugin while building your AEM app. In order to do so, run your build in debug mode:</p> <pre><code>mvnDebug clean install -Pinstall-assets
</code></pre> <p>Afterward, you can set breakpoints in your IDE, start a debugging session, and connect to the build process. The port is 8000.</p> </div> <footer class="footer-compact container-fluid"> <div class="container"> <hr class="footer-divider"> <div class="text-center text-gray"> <div>EAK v2.1.0  2022 <a class="footer-compact-link" href="https://exadel.com/" target="_blank">Exadel</a>, Inc</div> </div> </div> </footer> </main> <esl-scrollbar target="::prev" class="main-scroll"></esl-scrollbar> <div class="header-shadow"></div> </div> <script src="/etoolbox-authoring-kit/bundles/localdev.js"></script>   </body>