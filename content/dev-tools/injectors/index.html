<head> <title>Injectors - Exadel Authoring Kit</title> <link rel="canonical" href="https://exadel-ink.github.io/content/dev-tools/injectors"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <link rel="icon" type="image/png" href="/etoolbox-authoring-kit/assets/logo-64x64.png"> <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-FTFSXX8LXV"></script> <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-FTFSXX8LXV")</script> <script>!function(){var e="";"getRootNode"in Element.prototype&&window.customElements?window.scrollBy&&window.IntersectionObserver&&window.ResizeObserver&&window.ResizeObserver||(e="light"):e="medium",e&&document.write('<script type="text/javascript" src="/etoolbox-authoring-kit/bundles/polyfill-'+e+'.js"><\/script>')}()</script> <link rel="stylesheet" type="text/css" href="/etoolbox-authoring-kit/bundles/site.css"> </head> <body> <div class="page sidebar-layout"> <header class="header"> <nav class="header-container container"> <a class="header-link header-logo logo-animated" href="/etoolbox-authoring-kit/" aria-label="landing page"> <svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 38 38"> <g clip-path="url(#a)" fill-rule="evenodd" clip-rule="evenodd" fill="#0082CA"> <path d="M23.7024 17.967a1.4253 1.4253 0 0 0 1.4276.7264 1.4273 1.4273 0 0 0 1.2019-1.0588 1.4265 1.4265 0 0 0-.16-1.0926L20.3532 6.4634A1.4044 1.4044 0 0 0 19 5.762a1.427 1.427 0 0 0-1.354.7014L6.9582 24.9731a1.4257 1.4257 0 0 0 .5227 1.9477 1.424 1.424 0 0 0 .527.1786 1.4243 1.4243 0 0 0 1.054-.2829 1.4253 1.4253 0 0 0 .3667-.4184L19 9.8206l4.7024 8.1464Z"></path> <path d="m31.0418 24.8667-2.2336-3.8608a1.399 1.399 0 0 0-.6642-.5941 1.4256 1.4256 0 0 0-.7608-.2253H15.7457a1.4251 1.4251 0 0 0 0 2.85h10.9512l1.8763 3.2534a1.426 1.426 0 0 0 2.5758-.3632 1.4255 1.4255 0 0 0-.1072-1.06Z"></path> <path d="M38 19C38 8.5029 29.4971 0 19 0S0 8.5029 0 19s8.502 19 19 19a18.859 18.859 0 0 0 8.134-1.8311 1.4094 1.4094 0 0 1-.7599-1.2113 17.567 17.567 0 0 1-7.3599 1.6148c-9.7017 0-17.575-7.8724-17.575-17.5751C1.4392 9.2947 9.2982 1.425 19 1.425c9.7017 0 17.575 7.876 17.575 17.575a17.4351 17.4351 0 0 1-3.1594 10.0467 1.4199 1.4199 0 0 1 .5471 1.1164v.5462A18.924 18.924 0 0 0 38 19Z"></path> <path d="M32.3001 29.6877h-4.2732a.7133.7133 0 0 0 0 1.4268h3.562v1.1873a.7125.7125 0 0 0 1.425 0v-1.8967a.7159.7159 0 0 0-.2081-.5068.7143.7143 0 0 0-.5057-.2106ZM32.0624 33.9627h-3.3261v-1.425a.7125.7125 0 1 0-1.425 0v2.1379a.7147.7147 0 0 0 .7094.7094h4.0373a.7125.7125 0 0 0 0-1.425l.0044.0027Z"></path> </g> <defs> <clipPath id="a"> <path fill="#fff" d="M0 0h38v38H0z"></path> </clipPath> </defs> </svg> <span class="header-short-name">Exadel Authoring Kit</span> <span class="header-long-name">Exadel Authoring Kit for AEM</span> </a> <ul class="header-links unstyled-list"> <li class="header-item"> <a class="header-link" href=".">Manuals</a> </li> <li class="header-item"> <a class="header-link" href="" target="_blank">API Docs</a> </li> <li class="header-item"> <a class="header-link" href="" target="_blank">Blog</a> </li> <li class="header-item"> <a class="header-link fill-primary" href="https://github.com/exadel-inc/etoolbox-authoring-kit" target="_blank"> <svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"> <path d="M10.6666 14.6668v-2.58a2.246 2.246 0 0 0-.6266-1.74c2.0933-.2333 4.2933-1.0267 4.2933-4.6667a3.6268 3.6268 0 0 0-1-2.5 3.38 3.38 0 0 0-.06-2.5133s-.7867-.2333-2.6067.9867a8.92 8.92 0 0 0-4.6666 0C4.18.4335 3.3933.6668 3.3933.6668a3.38 3.38 0 0 0-.06 2.5133 3.6267 3.6267 0 0 0-1 2.52c0 3.6133 2.2 4.4067 4.2934 4.6667A2.2458 2.2458 0 0 0 6 12.0868v2.58" fill="#0082CA"></path> <path d="M6 12.6668c-3.3333 1-3.3333-1.6667-4.6667-2m9.3333 4v-2.58a2.246 2.246 0 0 0-.6266-1.74c2.0933-.2333 4.2933-1.0267 4.2933-4.6667a3.6268 3.6268 0 0 0-1-2.5 3.38 3.38 0 0 0-.06-2.5133s-.7867-.2333-2.6067.9867a8.92 8.92 0 0 0-4.6666 0C4.18.4335 3.3933.6668 3.3933.6668a3.38 3.38 0 0 0-.06 2.5133 3.6267 3.6267 0 0 0-1 2.52c0 3.6133 2.2 4.4067 4.2934 4.6667A2.2458 2.2458 0 0 0 6 12.0868v2.58h4.6666Z" stroke="#0082CA" stroke-linecap="round" stroke-linejoin="round"></path> </svg> </a> </li> </ul> <div class="header-utility"> <esl-trigger class="header-hamburger" target="#sidebar" aria-label="navigation menu"></esl-trigger> </div> </nav> </header> <eak-sidebar id="sidebar" class="open" aria-label="Site Navigation"> <nav class="sidebar-nav"> <a class="sidebar-heading" href="/etoolbox-authoring-kit/"> <span class="sidebar-logo"> <svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 38 38"> <g clip-path="url(#a)" fill-rule="evenodd" clip-rule="evenodd" fill="#0082CA"> <path d="M23.7024 17.967a1.4253 1.4253 0 0 0 1.4276.7264 1.4273 1.4273 0 0 0 1.2019-1.0588 1.4265 1.4265 0 0 0-.16-1.0926L20.3532 6.4634A1.4044 1.4044 0 0 0 19 5.762a1.427 1.427 0 0 0-1.354.7014L6.9582 24.9731a1.4257 1.4257 0 0 0 .5227 1.9477 1.424 1.424 0 0 0 .527.1786 1.4243 1.4243 0 0 0 1.054-.2829 1.4253 1.4253 0 0 0 .3667-.4184L19 9.8206l4.7024 8.1464Z"></path> <path d="m31.0418 24.8667-2.2336-3.8608a1.399 1.399 0 0 0-.6642-.5941 1.4256 1.4256 0 0 0-.7608-.2253H15.7457a1.4251 1.4251 0 0 0 0 2.85h10.9512l1.8763 3.2534a1.426 1.426 0 0 0 2.5758-.3632 1.4255 1.4255 0 0 0-.1072-1.06Z"></path> <path d="M38 19C38 8.5029 29.4971 0 19 0S0 8.5029 0 19s8.502 19 19 19a18.859 18.859 0 0 0 8.134-1.8311 1.4094 1.4094 0 0 1-.7599-1.2113 17.567 17.567 0 0 1-7.3599 1.6148c-9.7017 0-17.575-7.8724-17.575-17.5751C1.4392 9.2947 9.2982 1.425 19 1.425c9.7017 0 17.575 7.876 17.575 17.575a17.4351 17.4351 0 0 1-3.1594 10.0467 1.4199 1.4199 0 0 1 .5471 1.1164v.5462A18.924 18.924 0 0 0 38 19Z"></path> <path d="M32.3001 29.6877h-4.2732a.7133.7133 0 0 0 0 1.4268h3.562v1.1873a.7125.7125 0 0 0 1.425 0v-1.8967a.7159.7159 0 0 0-.2081-.5068.7143.7143 0 0 0-.5057-.2106ZM32.0624 33.9627h-3.3261v-1.425a.7125.7125 0 1 0-1.425 0v2.1379a.7147.7147 0 0 0 .7094.7094h4.0373a.7125.7125 0 0 0 0-1.425l.0044.0027Z"></path> </g> <defs> <clipPath id="a"> <path fill="#fff" d="M0 0h38v38H0z"></path> </clipPath> </defs> </svg> </span> <span class="sidebar-title">Exadel Authoring Kit for AEM</span> </a> <div class="sidebar-content"> <div class="sidebar-scrollable-content esl-scrollable-content"> <ul class="sidebar-nav-list"> <li class="sidebar-nav-item"> <div class="sidebar-nav-item-heading"> Getting Started </div> <div class="sidebar-nav-secondary"> <ul class="sidebar-nav-secondary-list"> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/getting-started/installation/"> Installation </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/getting-started/common-use-cases/"> Common Use Cases </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/getting-started/popular-articles/"> Popular Articles </a> </li> </ul> </div> </li> <li class="sidebar-nav-item"> <div class="sidebar-nav-item-heading"> Developer Tools </div> <div class="sidebar-nav-secondary"> <ul class="sidebar-nav-secondary-list"> <li class="sidebar-nav-secondary-item sidebar-secondary-nav-item-children"> <div class="sidebar-nav-item-heading"> <esl-trigger class="sidebar-nav-item-trigger sidebar-nav-item-arrow" target="::parent::next"> Component Management </esl-trigger> </div> <esl-panel id="sidebar-component-management-menu" class="sidebar-nav-secondary nav-secondary-panel" group=" component-management"> <ul class="sidebar-nav-secondary-list"> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/component-management/component-structure/"> Component Structure </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/component-management/dialog-layout/"> Dialog Layout </a> </li> <li class="sidebar-nav-secondary-item sidebar-secondary-nav-item-children"> <div class="sidebar-nav-item-heading"> <esl-trigger class="sidebar-nav-item-trigger sidebar-nav-item-arrow" target="::parent::next"> Dialog Fields </esl-trigger> </div> <esl-panel id="sidebar-dialog-fields-menu" class="sidebar-nav-secondary nav-secondary-panel" group=" dialog-fields"> <ul class="sidebar-nav-secondary-list"> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/component-management/dialog-fields/dialog-field/"> Dialog Field </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/component-management/dialog-fields/widgets/"> Widgets (A-Z) </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/component-management/dialog-fields/configuring-rte/"> Configuring RTE </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/component-management/dialog-fields/configuring-fieldset/"> Configuring Fieldset </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/component-management/dialog-fields/configuring-multifield/"> Configuring Multifield </a> </li> </ul> </esl-panel> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/component-management/additional-properties/"> Additional Properties </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/component-management/reusing-code/"> Reusing Code </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/component-management/customizing-toolkit/"> Customization </a> </li> </ul> </esl-panel> </li> <li class="sidebar-nav-secondary-item sidebar-secondary-nav-item-children"> <div class="sidebar-nav-item-heading"> <esl-trigger class="sidebar-nav-item-trigger sidebar-nav-item-arrow" target="::parent::next"> DependsOn </esl-trigger> </div> <esl-panel id="sidebar-depends-on-menu" class="sidebar-nav-secondary nav-secondary-panel" group=" depends-on"> <ul class="sidebar-nav-secondary-list"> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/depends-on/introduction/"> Introduction </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/depends-on/usage/"> Usage </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/depends-on/api/"> API </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/depends-on/examples/"> Examples </a> </li> </ul> </esl-panel> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/option-provider/"> Option Provider </a> </li> <li class="sidebar-nav-secondary-item active" aria-selected="true"> <a class="sidebar-nav-secondary-link" aria-current="page" href="/etoolbox-authoring-kit/content/dev-tools/injectors/"> Injectors </a> </li> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/dev-tools/allowed-components/"> Allowed Components </a> </li> </ul> </div> </li> <li class="sidebar-nav-item"> <div class="sidebar-nav-item-heading"> Authoring Tools </div> <div class="sidebar-nav-secondary"> <ul class="sidebar-nav-secondary-list"> <li class="sidebar-nav-secondary-item"> <a class="sidebar-nav-secondary-link" href="/etoolbox-authoring-kit/content/authoring-tools/etoolbox-lists/"> Etoolbox Lists </a> </li> </ul> </div> </li> </ul> <div class="sidebar-footer-copyright"> EAK v2.2.0 © 2022<a class="sidebar-footer-link" href="https://exadel.com/" target="_blank">Exadel</a>, Inc. </div> </div> <esl-scrollbar class="sidebar-scrollbar" target="::prev"></esl-scrollbar> </div> </nav> </eak-sidebar> <main class="esl-scrollable-content"> <div class="content container markdown-container"> <h2 id="enhancing-aem-components'-back-end-with-advanced-injectors">Enhancing AEM Components' back-end with advanced Injectors</h2> <p><a href="https://sling.apache.org/documentation/bundles/models.html#custom-injectors-1">Injectors</a> are a powerful feature of Apache Sling that is massively used across modern AEM projects. Injectors pass data directly to the Java classes that back AEM components. This reduces boilerplate code and simplifies authoring as well.</p> <p>Exadel Toolbox Authoring Kit (<em>ToolKit</em>) offers a number of Injectors you can use in your projects: both bound to other ToolKit features and independent.</p> <h3 id="injector-for-etoolbox-lists">Injector for EToolbox Lists</h3> <p>You can use it to inject the content of an EToolbox List directly into your Sling model. This injector can be used with either a field, a method, or a constructor argument. You can retrieve either a <em>Collection</em> / <em>List</em> of list items or a map depending on the type of the underlying variable (or else the return type of the underlying method).</p> <p>To get the collection / list of items, use a notation as the following:</p> <pre><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SampleModel</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token annotation punctuation">@EToolboxList</span><span class="token punctuation">(</span><span class="token string">"/content/etoolbox-lists/contentList"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SimpleListItem</span><span class="token punctuation">&gt;</span></span> itemsListResource<span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

</code></pre> <p>Note that your injected field's type can be either a <code>List</code> or an array, like <code>SimpleListItem[]</code>. Concerning the type of items, you can specify a valid Sling model, or a <em>Resource</em>, or else <em>Object</em>. In the latter case, <em>Resource</em>-s will be injected in place of <em>Object</em>-s. In the snippets we use the out-of-the-box <em>SimpleListItem</em>. However, any valid Sling model will go (if it is adapted from a <em>Resource</em>). Generally, this injector works according to the same principles as the <a href="https://javadoc.io/doc/com.exadel.etoolbox/etoolbox-authoring-kit-core/latest/com/exadel/aem/toolkit/core/lists/utils/ListHelper.html">ListHelper</a> utility class.</p> <p>To get the map, type it as:</p> <pre><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SampleModel</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token annotation punctuation">@EToolboxList</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/content/etoolbox-lists/contentList"</span><span class="token punctuation">,</span> keyProperty <span class="token operator">=</span> <span class="token string">"textValue"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">EToolboxListInjectorTest<span class="token punctuation">.</span>LocalListItemModel</span><span class="token punctuation">&gt;</span></span> itemsMapTestModel<span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <p>The optional <em>keyProperty</em> parameter is responsible for which of the properties of a list item is to be used as the map key. By default it is the <em>jcr:title</em> property.</p> <p>When applying the injector to a constructor, please use the following format:</p> <pre><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SampleModel</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token annotation punctuation">@Inject</span>
    <span class="token keyword">public</span> <span class="token class-name">TestModelEToolboxList</span><span class="token punctuation">(</span><span class="token annotation punctuation">@EToolboxList</span><span class="token punctuation">(</span><span class="token string">"/content/etoolbox-lists/myList"</span><span class="token punctuation">)</span> <span class="token annotation punctuation">@Named</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Resource</span><span class="token punctuation">&gt;</span></span> listResource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>itemsListResourceFromMethodParameter <span class="token operator">=</span> listResource<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <h3 id="injector-for-a-child-(or-relative)-resource">Injector for a child (or relative) resource</h3> <p>it is often needed to inject a relative resource (by its path) or a derived Sling model into the current model. Usually, this is achieved through such annotations as <em>@ChildResource</em> or <em>@ChildResourceWithRequest</em>. However both solutions have their limitations. To bypass some of them you can use the <code>@Child</code> annotation from the <em>ToolKit</em>.</p> <p>Among the advantages are:</p> <ul> <li>ability to inject any resource by an absolute or relative path (in fact not only a child or a "grandchild", but also a parent, or an unrelated resource, or even the current resource itself);</li> <li>ability to inject a secondary Sling model adapted from such resource (or else from a resource wrapped in a synthetic request);</li> <li>ability to select particular properties from a target resource used for injection and/or adaptation into a secondary model. This way, you can create and manage several "virtual" resources from one "real" resource.</li> </ul> <p>Consider the following code samples:</p> <pre><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SampleModel</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token annotation punctuation">@Child</span>
    <span class="token keyword">private</span> <span class="token class-name">Resource</span> childResource<span class="token punctuation">;</span> <span class="token comment">// The direct child of the current resource by the self-implied name "childResource" is injected</span>

    <span class="token annotation punctuation">@Child</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"list"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Resource</span> listResource<span class="token punctuation">;</span> <span class="token comment">// The direct child of the current resource by the name "list" is injected</span>

    <span class="token annotation punctuation">@Child</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"./list"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Object</span> listResource<span class="token punctuation">;</span> <span class="token comment">// Same as above. If a field is of "Object" type, Resource is injected</span>

    <span class="token annotation punctuation">@Child</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">".."</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Resource</span> parent<span class="token punctuation">;</span> <span class="token comment">// The direct parent of the current resource is injected</span>

    <span class="token annotation punctuation">@Child</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"/content/myPage/jcr:content/myResource"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">ListItemModel</span> modelByAbsolutePath<span class="token punctuation">;</span> <span class="token comment">// An adaptation of the current resource to the "ListItemModel" class is injected</span>

    <span class="token annotation punctuation">@Child</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"some/path/nestedListItem"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">ListItemModel</span> modelByRelativePath<span class="token punctuation">;</span> <span class="token comment">// Same as above; a relative path is used</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <p>The other example will show how to virtually "split" one resource into several "sub-resources" representing different entities (e.g., fieldsets) in the course of injection. Consider you have to manage a resource with the properties like:</p> <pre><code>jcr:primaryType = "nt:unstructured"
sling:resourceType = "some/resource/type"
fieldset1_title = "Hello"
fieldset1_description = "Earth"
fieldset2_title = "Goodbye"
fieldset2_description = "Moon"
</code></pre> <p>There are two obvious "sub-resources" within this structure. They can be addressed to separately like in the sample:</p> <pre><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SampleModel</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token annotation punctuation">@Child</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"fieldset1_"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">TextDescriptionFieldset</span> first<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Child</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"fieldset2_"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">TextDescriptionFieldset</span> second<span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <p>While the referenced model itself can have the following listing:</p> <pre><code class="language-java"><span class="token annotation punctuation">@Model</span><span class="token punctuation">(</span>adaptables <span class="token operator">=</span> <span class="token class-name">Resource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TextDescriptionFieldset</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@ValueMapValue</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> text<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ValueMapValue</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> description<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <p>Combined, these pieces will produce the following result (pseudocode):</p> <pre><code>first.text == "Hello";
first.description = "Earth";
second.text == "Goodbye";
second.description == "Moon";
</code></pre> <p>The same principle applies to the <em>postfix</em> property.</p> <p>Note: the <code>@Child</code> annotation can be used with either a field, a method, or a constructor argument. When using with a constructor, use the notation like <code>(@Child @Named SomeModel argument)</code> and annotate the constructor itself with <code>@Inject</code>.</p> <h3 id="injector-for-a-list-of-child-resources">Injector for a list of child resources</h3> <p>The <code>@Children</code> injector follows much the same pattern as the <code>@Child</code> annotation. The differences are:</p> <ul> <li>it is used with fields, methods, or constructor arguments that are typed as <em>Collection</em> (<em>List</em>) or an array;</li> <li>the path specified in the annotation doesn't point to the particular resource, but a parent resource <em>children of which</em> will be injected;</li> <li>there's the ability to filter children with a predicate.</li> </ul> <p>See the following samples:</p> <pre><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SampleModel</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Children</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Resource</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">;</span> <span class="token comment">// Will inject children of the subresource named "list" of the current resource</span>

    <span class="token annotation punctuation">@Children</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"./list"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Resource</span><span class="token punctuation">&gt;</span></span> resourceList<span class="token punctuation">;</span> <span class="token comment">// Same as above. You could also specify "list" without "./"</span>

    <span class="token annotation punctuation">@Children</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"./"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> ownList<span class="token punctuation">;</span> <span class="token comment">// Will inject children of the current resource</span>

    <span class="token annotation punctuation">@Children</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"/content/nested-node"</span><span class="token punctuation">,</span> prefix <span class="token operator">=</span> <span class="token string">"prefix_"</span><span class="token punctuation">)</span>
    <span class="token comment">// Will inject children of "/content/nested-node" adapted to the "ListItemModel" class.</span>
    <span class="token comment">// Will only consider the properties names of which start with "prefix_"</span>
    <span class="token keyword">private</span> <span class="token class-name">ListItemModel</span><span class="token punctuation">[</span><span class="token punctuation">]</span> listItemModelsWithPrefix<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Children</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"/content/nested-node"</span><span class="token punctuation">,</span> postfix <span class="token operator">=</span> <span class="token string">"-secondary"</span><span class="token punctuation">)</span>
    <span class="token comment">// Will inject children of "/content/nested-node" adapted to the "ListItemModel" class.</span>
    <span class="token comment">// Will only consider the properties names of which end with "-secondary"</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ListItemModel</span><span class="token punctuation">&gt;</span></span> listItemModelsWithPrefix<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <p>Children's filters can be specified as references to classes that implement <code>Predicate&lt;Resource&gt;</code>:</p> <pre><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SampleModel</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Children</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"list"</span><span class="token punctuation">,</span> filters <span class="token operator">=</span> <span class="token class-name">DateIsNotFuture</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ListItemModel</span><span class="token punctuation">&gt;</span></span> listItemModels<span class="token punctuation">;</span>

    <span class="token comment">// ...</span>

    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DateIsNotFuture</span> <span class="token keyword">implements</span> <span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Resource</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token class-name">Resource</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Calendar</span> date <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">getValueMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"date"</span><span class="token punctuation">,</span> <span class="token class-name">Calendar</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> date <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>date<span class="token punctuation">.</span><span class="token function">after</span><span class="token punctuation">(</span><span class="token class-name">Calendar</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>Some filters are supplied out of the box. E.g., <code>NonGhostFilter</code> allows filtering out "ghost component" resources (those with the resource type "<em>wcm/msm/components/ghost</em>"). The <code>NonNullFilter</code> filters out invalid/null children.</p> <p>Note: the <code>@Children</code> annotation can be used with either a field, a method, or a constructor argument. When using with a constructor, write it like <code>(@Children @Named("path") List&lt;ListItemModel&gt; argument)</code> or else <code>(@Children(name = "path") @Named List&lt;ListItemModel&gt; argument)</code> and also annotate the constructor itself with <code>@Inject</code>.</p> <h3 id="injector-for-request-parameters">Injector for request parameters</h3> <p>The <code>@RequestParam</code> annotation is used to inject a request parameter. The annotated member can be of type <em>String</em> or <em>Object</em>, then a value coerced to string is injected. Else, the parameter can be of type <em>RequestParameter</em> (including a list or an array of that type) or <em>RequestParameterMap</em> so that the corresponding objects obtained via the <em>SlingHttpServletRequest</em> could be injected.</p> <p>Note: this annotation can be used with either a field, a method, or a constructor argument. When using with a constructor, use the notation like <code>(@RequestParam @Named String argument)</code> and annotate the constructor itself with <code>@Inject</code>.</p> <h3 id="injector-for-request-selectors">Injector for request selectors</h3> <p>The <code>@RequestSelectors</code> annotation can be used to inject Sling request selectors. If the annotated member is of type * String* or <em>Object</em>, the "whole" selector string is injected. But if the annotated member represents an array or a list of strings or objects, selectors are injected one by one in the underlying <em>List</em> or array.</p> <p>See the code samples:</p> <pre><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SampleModel</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token annotation punctuation">@RequestSelectors</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> selectorsString<span class="token punctuation">;</span> <span class="token comment">// Will inject all selectors like "selector1.selector2.selector3"</span>

    <span class="token annotation punctuation">@RequestSelectors</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> selectorsList<span class="token punctuation">;</span> <span class="token comment">// Will inject the list of selectors</span>

    <span class="token annotation punctuation">@RequestSelectors</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> selectorsArray<span class="token punctuation">;</span> <span class="token comment">// Will inject the array of selectors</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <p>Note: this annotation can be used with either a field, a method, or a constructor argument. When using with a constructor, use the notation like <code>(@RequestSelectors @Named String argument)</code> and annotate the constructor itself with <code>@Inject</code>.</p> <h3 id="injector-for-request-suffix">Injector for request suffix</h3> <p>The <code>@RequestSuffix</code> is used to inject a Sling request suffix. If the annotated member is of type <em>String</em> or <em>Object</em>, the string value of suffix is injected. If the annotated member is of type <em>Resource</em>, the injector will inject the corresponding JCR resource.</p> <p>Note: this annotation can be used with either a field, a method, or a constructor argument. When using with a constructor, write it like <code>(@RequestSuffix @Named String argument)</code> and annotate the constructor itself with <code>@Inject</code>.</p> <h3 id="injector-for-i18n">Injector for I18n</h3> <p>The <code>@I18N</code> annotation can be used to inject either the OOTB <code>I18n</code> object or a particular internationalized value. Therefore, it is legitimate to use this annotation with an <em>I18n</em>-typed or a <em>String</em>-typed class member (and also with an <em>Object</em>-typed member which is then considered a string).</p> <p>The behavior of <em>I18N</em> depends on the current locale. By default, the locale is guessed from the path of the page the current resource belongs to, or else the <em>jcr:language</em> property of that page. That is, a resource with the path like <code>/content/site/us/en/myPage/jcr:content/resource</code> or <code>/content/site/us-en/myPage/jcr:content/resource</code> will be considered belonging to the <em>en_US</em> locale.</p> <p>You can override this guessing in two ways:</p> <ul> <li>directly specify the <em>locale</em> parameter of <code>@I18N</code>. The <em>locale</em> can contain either a two-char language token, or a 5-char language-and-country in one of the following formats: <em>en-us</em>, <em>en_us</em>, <em>en/us</em>. Mind that the language token always comes first, and the country token comes second;</li> <li>or specify a reference to a locale detector. A locale detector is a class which implements <code>Function&lt;Object, Locale&gt;</code>. The <em>Object</em> argument is the adaptable (usually a request or a resource). There are two predefined locale detectors: the <code>PageLocaleDetector</code> (it implements guessing by the page path as described above; you don't have to specify it manually), and the <code>NativeLocaleDetector</code>. If the latter is specified, the returned locale is effectively <em>null</em> which triggers the native AEM behavior - the locale is then derived from the logged user's preferences.</li> </ul> <p>If both <em>locale</em> and <em>localeDetector</em> are specified, <em>locale</em> takes precedence.</p> <p>When using <code>@I18N</code> with a String-typed class member you can specify the value to be internationalized. Use either to <em>value</em> property of <code>@I18N</code> or the standard <code>@Named</code> annotation. If none of these is present, the string to internationalize will derive from the name of the underlying class member.</p> <p>Please take into account that AEM operates with resource bundles specified by both language and country. So if you specify a locale as <em>"en"</em> in one place and <em>"en-us"</em> elsewhere, these may be considered as two different locales and different resource bundles.</p> <pre><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SampleModel</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token annotation punctuation">@I18N</span>
    <span class="token keyword">private</span> <span class="token class-name">I18n</span> i18n<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@I18N</span><span class="token punctuation">(</span>locale <span class="token operator">=</span> <span class="token string">"it-it"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">I18n</span> i18nItalian<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@I18N</span><span class="token punctuation">(</span>localeDetector <span class="token operator">=</span> <span class="token class-name">NativeLocaleDetector</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">I18n</span> i18nFromUserPreferences<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@I18N</span><span class="token punctuation">(</span>locale <span class="token operator">=</span> <span class="token string">"it"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Named</span><span class="token punctuation">(</span><span class="token string">"Hello world"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> helloWorld<span class="token punctuation">;</span> <span class="token comment">// Injects the "Ciao mondo" value if such is present in the resource bundle</span>

    <span class="token annotation punctuation">@I18N</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"Hello world"</span><span class="token punctuation">,</span> localeDetector <span class="token operator">=</span> <span class="token class-name">MyDetectorReturnsItalian</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> helloWorld2<span class="token punctuation">;</span> <span class="token comment">// Same as above</span>
<span class="token punctuation">}</span>
</code></pre> <p>Note: this annotation can be used with either a field, a method, or a constructor argument. When using with a constructor, write it like <code>(@I18N @Named String argument)</code> and annotate the constructor itself with <code>@Inject</code>.</p> </div> <footer class="footer-compact container-fluid"> <div class="container"> <hr> <div class="footer-compact-copyright"> EAK v2.2.0 © 2022 <a class="footer-compact-link" href="https://exadel.com/" target="_blank">Exadel</a>, Inc </div> </div> </footer> </main> <esl-scrollbar target="::prev" class="main-scroll"></esl-scrollbar> <div class="header-shadow"></div> </div> <script src="/etoolbox-authoring-kit/bundles/site.js"></script>   </body>